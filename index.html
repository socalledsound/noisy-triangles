<!DOCTYPE html>
<html>
<head>
<title>---</title>
<meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport" />
<meta charset="utf-8"></head>
<body></body>
<script>!function r(i,a,o){function f(t,e){if(!a[t]){if(!i[t]){var n="function"==typeof require&&require;if(!e&&n)return n(t,!0);if(u)return u(t,!0);throw(n=new Error("Cannot find module '"+t+"'")).code="MODULE_NOT_FOUND",n}n=a[t]={exports:{}},i[t][0].call(n.exports,function(e){return f(i[t][1][e]||e)},n,n.exports,r,i,a,o)}return a[t].exports}for(var u="function"==typeof require&&require,e=0;e<o.length;e++)f(o[e]);return f}({1:[function(e,t,n){t.exports=function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}},{}],2:[function(e,t,n){var h=e("./identity");t.exports=function(e,t,n,r){var i,a=t[0],o=t[1],f=t[2],u=r[0],s=r[1],c=r[2],l=n[0],p=n[1],d=n[2];if(Math.abs(a-l)<1e-6&&Math.abs(o-p)<1e-6&&Math.abs(f-d)<1e-6)return h(e);i=a-l,t=o-p,r=f-d,n=1/Math.sqrt(i*i+t*t+r*r),l=s*(r*=n)-c*(t*=n),p=c*(i*=n)-u*r,d=u*t-s*i,(n=Math.sqrt(l*l+p*p+d*d))?(l*=n=1/n,p*=n,d*=n):d=p=l=0;c=t*d-r*p,u=r*l-i*d,s=i*p-t*l,(n=Math.sqrt(c*c+u*u+s*s))?(c*=n=1/n,u*=n,s*=n):s=u=c=0;return e[0]=l,e[1]=c,e[2]=i,e[3]=0,e[4]=p,e[5]=u,e[6]=t,e[7]=0,e[8]=d,e[9]=s,e[10]=r,e[11]=0,e[12]=-(l*a+p*o+d*f),e[13]=-(c*a+u*o+s*f),e[14]=-(i*a+t*o+r*f),e[15]=1,e}},{"./identity":1}],3:[function(e,t,n){t.exports=function(e,t,n,r,i){var a=1/Math.tan(t/2),t=1/(r-i);return e[0]=a/n,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=a,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=(i+r)*t,e[11]=-1,e[12]=0,e[13]=0,e[14]=2*i*r*t,e[15]=0,e}},{}],4:[function(e,t,n){t.exports=function(e){"string"==typeof e&&(e=[e]);for(var t=[].slice.call(arguments,1),n=[],r=0;r<e.length-1;r++)n.push(e[r],t[r]||"");return n.push(e[r]),n.join("")}},{}],5:[function(e,t,n){"use strict";t.exports=function(t,i){i||(i=t,t=window);var a=0,o=0,f=0,u={shift:!1,alt:!1,control:!1,meta:!1},n=!1;function s(e){var t=!1;return"altKey"in e&&(t=t||e.altKey!==u.alt,u.alt=!!e.altKey),"shiftKey"in e&&(t=t||e.shiftKey!==u.shift,u.shift=!!e.shiftKey),"ctrlKey"in e&&(t=t||e.ctrlKey!==u.control,u.control=!!e.ctrlKey),"metaKey"in e&&(t=t||e.metaKey!==u.meta,u.meta=!!e.metaKey),t}function r(e,t){var n=v.x(t),r=v.y(t);"buttons"in t&&(e=0|t.buttons),e===a&&n===o&&r===f&&!s(t)||(a=0|e,o=n||0,f=r||0,i&&i(a,o,f,u))}function c(e){r(0,e)}function l(){(a||o||f||u.shift||u.alt||u.meta||u.control)&&(o=f=0,a=0,u.shift=u.alt=u.control=u.meta=!1,i&&i(0,0,0,u))}function p(e){s(e)&&i&&i(a,o,f,u)}function d(e){0===v.buttons(e)?r(0,e):r(a,e)}function h(e){r(a|v.buttons(e),e)}function m(e){r(a&~v.buttons(e),e)}function b(){n||(n=!0,t.addEventListener("mousemove",d),t.addEventListener("mousedown",h),t.addEventListener("mouseup",m),t.addEventListener("mouseleave",c),t.addEventListener("mouseenter",c),t.addEventListener("mouseout",c),t.addEventListener("mouseover",c),t.addEventListener("blur",l),t.addEventListener("keyup",p),t.addEventListener("keydown",p),t.addEventListener("keypress",p),t!==window&&(window.addEventListener("blur",l),window.addEventListener("keyup",p),window.addEventListener("keydown",p),window.addEventListener("keypress",p)))}b();var e={element:t};return Object.defineProperties(e,{enabled:{get:function(){return n},set:function(e){e?b():n&&(n=!1,t.removeEventListener("mousemove",d),t.removeEventListener("mousedown",h),t.removeEventListener("mouseup",m),t.removeEventListener("mouseleave",c),t.removeEventListener("mouseenter",c),t.removeEventListener("mouseout",c),t.removeEventListener("mouseover",c),t.removeEventListener("blur",l),t.removeEventListener("keyup",p),t.removeEventListener("keydown",p),t.removeEventListener("keypress",p),t!==window&&(window.removeEventListener("blur",l),window.removeEventListener("keyup",p),window.removeEventListener("keydown",p),window.removeEventListener("keypress",p)))},enumerable:!0},buttons:{get:function(){return a},enumerable:!0},x:{get:function(){return o},enumerable:!0},y:{get:function(){return f},enumerable:!0},mods:{get:function(){return u},enumerable:!0}}),e};var v=e("mouse-event")},{"mouse-event":6}],6:[function(e,t,n){"use strict";function r(e){return e.target||e.srcElement||window}n.buttons=function(e){if("object"==typeof e){if("buttons"in e)return e.buttons;if("which"in e){if(2===(t=e.which))return 4;if(3===t)return 2;if(0<t)return 1<<t-1}else if("button"in e){var t;if(1===(t=e.button))return 4;if(2===t)return 2;if(0<=t)return 1<<t}}return 0},n.element=r,n.x=function(e){if("object"!=typeof e)return 0;if("offsetX"in e)return e.offsetX;var t=r(e).getBoundingClientRect();return e.clientX-t.left},n.y=function(e){if("object"!=typeof e)return 0;if("offsetY"in e)return e.offsetY;var t=r(e).getBoundingClientRect();return e.clientY-t.top}},{}],7:[function(e,t,n){"use strict";var r=e("to-px");t.exports=function(e,a,o){"function"==typeof e&&(o=!!a,a=e,e=window);function t(e){o&&e.preventDefault();var t=e.deltaX||0,n=e.deltaY||0,r=e.deltaZ||0,i=1;switch(e.deltaMode){case 1:i=f;break;case 2:i=window.innerHeight}if(n*=i,r*=i,(t*=i)||n||r)return a(t,n,r,e)}var f=r("ex",e);return e.addEventListener("wheel",t),t}},{"to-px":11}],8:[function(e,t,n){t.exports=function(e,t){t=t||[0,""],e=String(e);var n=parseFloat(e,10);return t[0]=n,t[1]=e.match(/[\d.\-\+]*\s*(.*)/)[1]||"",t}},{}],9:[function(e,t,n){var c=e("mouse-change"),y=e("mouse-wheel"),x=e("gl-mat4/identity"),w=e("gl-mat4/perspective"),A=e("gl-mat4/lookAt");t.exports=function(n,e){var t=e||{};void 0===t.noScroll&&(t.noScroll=t.preventDefault);var l={view:x(new Float32Array(16)),projection:x(new Float32Array(16)),center:new Float32Array(t.center||3),theta:t.theta||0,phi:t.phi||0,distance:Math.log(t.distance||10),eye:new Float32Array(3),up:new Float32Array(t.up||[0,1,0]),fovy:t.fovy||Math.PI/4,near:void 0!==t.near?t.near:.01,far:void 0!==t.far?t.far:1e3,noScroll:void 0!==t.noScroll&&t.noScroll,flipY:!!t.flipY,dtheta:0,dphi:0,rotationSpeed:void 0!==t.rotationSpeed?t.rotationSpeed:1,zoomSpeed:void 0!==t.zoomSpeed?t.zoomSpeed:1,renderOnDirty:(t.renderOnDirty,!!t.renderOnDirty)},i=t.element,r=void 0!==t.damping?t.damping:.9,p=new Float32Array([1,0,0]),d=new Float32Array([0,0,1]),h=Math.log("minDistance"in t?t.minDistance:.1),m=Math.log("maxDistance"in t?t.maxDistance:1e3),b=0,a=0,o=0;{function f(){return i?i.offsetHeight:window.innerHeight}_&&!1!==t.mouse&&(e=i||n._gl.canvas,c(e,function(e,t,n){var r;1&e&&(r=(t-a)/(i?i.offsetWidth:window.innerWidth),e=(n-o)/f(),l.dtheta+=4*l.rotationSpeed*r,l.dphi+=4*l.rotationSpeed*e,l.dirty=!0),a=t,o=n}),y(e,function(e,t){b+=t/f()*l.zoomSpeed,l.dirty=!0},t.noScroll))}function v(e){e*=r;return Math.abs(e)<.1?0:(l.dirty=!0,e)}function g(e,t,n){return Math.min(Math.max(e,t),n)}l.dirty=!0;var u=n({context:Object.assign({},l,{dirty:function(){return l.dirty},projection:function(e){return w(l.projection,l.fovy,e.viewportWidth/e.viewportHeight,l.near,l.far),l.flipY&&(l.projection[5]*=-1),l.projection}}),uniforms:Object.keys(l).reduce(function(e,t){return e[t]=n.context(t),e},{})});function s(e,t){void 0!==s.dirty&&(l.dirty=s.dirty||l.dirty,s.dirty=void 0),e&&t&&(l.dirty=!0),l.renderOnDirty&&!l.dirty||(t||(t=e,e={}),function(t){Object.keys(t).forEach(function(e){l[e]=t[e]});var e=l.center,n=l.eye,r=l.up,i=l.dtheta,a=l.dphi;l.theta+=i,l.phi=g(l.phi+a,-Math.PI/2,Math.PI/2),l.distance=g(l.distance+b,h,m),l.dtheta=v(i),l.dphi=v(a),b=v(b);for(var o=l.theta,i=l.phi,f=(a=Math.exp(l.distance))*Math.sin(o)*Math.cos(i),u=a*Math.cos(o)*Math.cos(i),s=a*Math.sin(i),c=0;c<3;++c)n[c]=e[c]+f*d[c]+u*p[c]+s*r[c];A(l.view,n,e,r)}(e),u(t),l.dirty=!1)}return Object.keys(l).forEach(function(e){s[e]=l[e]}),s};var _="undefined"!=typeof window},{"gl-mat4/identity":1,"gl-mat4/lookAt":2,"gl-mat4/perspective":3,"mouse-change":5,"mouse-wheel":7}],10:[function(e,t,n){var r,i;r=this,i=function(){function i(e,t){this.id=r++,this.type=e,this.data=t}function n(e){return"["+function e(t){if(0===t.length)return[];var n=t.charAt(0),r=t.charAt(t.length-1);if(1<t.length&&n===r&&('"'===n||"'"===n))return['"'+t.substr(1,t.length-2).replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"'];if(n=/\[(false|true|null|\d+|'[^']*'|"[^"]*")\]/.exec(t))return e(t.substr(0,n.index)).concat(e(n[1])).concat(e(t.substr(n.index+n[0].length)));if(1===(n=t.split(".")).length)return['"'+t.replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"'];for(t=[],r=0;r<n.length;++r)t=t.concat(e(n[r]));return t}(e).join("][")+"]"}function x(e){return"string"==typeof e?e.split():e}function w(e){return"string"==typeof e?document.querySelector(e):e}function re(e){var t,n,r,i,a=e||{};e={};var o,f,u,s,c,l,p=[],d=[],h="undefined"==typeof window?1:window.devicePixelRatio,m=!1,b=function(e){},v=function(){};if("string"==typeof a?t=document.querySelector(a):"object"==typeof a&&("string"==typeof a.nodeName&&"function"==typeof a.appendChild&&"function"==typeof a.getBoundingClientRect?t=a:"function"==typeof a.drawArrays||"function"==typeof a.drawElements?r=(i=a).canvas:("gl"in a?i=a.gl:"canvas"in a?r=w(a.canvas):"container"in a&&(n=w(a.container)),"attributes"in a&&(e=a.attributes),"extensions"in a&&(p=x(a.extensions)),"optionalExtensions"in a&&(d=x(a.optionalExtensions)),"onDone"in a&&(b=a.onDone),"profile"in a&&(m=!!a.profile),"pixelRatio"in a&&(h=+a.pixelRatio))),t&&("canvas"===t.nodeName.toLowerCase()?r=t:n=t),!i){if(!r){if(u=n||document.body,s=h,l=document.createElement("canvas"),we(l.style,{border:0,margin:0,padding:0,top:0,left:0}),u.appendChild(l),u===document.body&&(l.style.position="absolute",we(u.style,{margin:0,padding:0})),u!==document.body&&"function"==typeof ResizeObserver?(c=new ResizeObserver(function(){setTimeout(y)})).observe(u):window.addEventListener("resize",y,!1),y(),!(t={canvas:l,onDestroy:function(){c?c.disconnect():window.removeEventListener("resize",y),u.removeChild(l)}}))return null;r=t.canvas,v=t.onDestroy}void 0===e.premultipliedAlpha&&(e.premultipliedAlpha=!0),o=r,f=e,i=g("webgl")||g("experimental-webgl")||g("webgl-experimental")}function g(e){try{return o.getContext(e,f)}catch(e){return null}}function y(){var e=window.innerWidth,t=window.innerHeight;u!==document.body&&(e=(t=u.getBoundingClientRect()).right-t.left,t=t.bottom-t.top),l.width=s*e,l.height=s*t,we(l.style,{width:e+"px",height:t+"px"})}return i?{gl:i,canvas:r,container:n,extensions:p,optionalExtensions:d,pixelRatio:h,profile:m,onDone:b,onDestroy:v}:(v(),b("webgl not supported, try upgrading your browser or graphics drivers http://get.webgl.org"),null)}function Z(e,t){for(var n=Array(e),r=0;r<e;++r)n[r]=t(r);return n}function a(e){var t,n=(65535<e)<<4;return n|=t=(255<(e>>>=n))<<3,(n|=t=(15<(e>>>=t))<<2)|(t=(3<(e>>>=t))<<1)|e>>>t>>1}function e(){function r(e){e:{for(var t=16;t<=268435456;t*=16)if(e<=t){e=t;break e}e=0}return 0<(t=n[a(e)>>2]).length?t.pop():new ArrayBuffer(e)}function t(e){n[a(e.byteLength)>>2].push(e)}var n=Z(8,function(){return[]});return{alloc:r,free:t,allocType:function(e,t){var n=null;switch(e){case 5120:n=new Int8Array(r(t),0,t);break;case 5121:n=new Uint8Array(r(t),0,t);break;case 5122:n=new Int16Array(r(2*t),0,t);break;case 5123:n=new Uint16Array(r(2*t),0,t);break;case 5124:n=new Int32Array(r(4*t),0,t);break;case 5125:n=new Uint32Array(r(4*t),0,t);break;case 5126:n=new Float32Array(r(4*t),0,t);break;default:return null}return n.length!==t?n.subarray(0,t):n},freeType:function(e){t(e.buffer)}}}function ie(e){return!!e&&"object"==typeof e&&Array.isArray(e.shape)&&Array.isArray(e.stride)&&"number"==typeof e.offset&&e.shape.length===e.stride.length&&(Array.isArray(e.data)||Oe(e.data))}function l(e,t,n,r,i,a){for(var o=0;o<t;++o)for(var f=e[o],u=0;u<n;++u)for(var s=f[u],c=0;c<r;++c)i[a++]=s[c]}function ae(e){return 0|Ce[Object.prototype.toString.call(e)]}function oe(e,t){for(var n=0;n<t.length;++n)e[n]=t[n]}function fe(e,t,n,r,i,a,o){for(var f=0,u=0;u<n;++u)for(var s=0;s<r;++s)e[f++]=t[i*u+a*s+o]}function ue(e){for(var t,n,r,i=Ee.allocType(5123,e.length),a=0;a<e.length;++a)isNaN(e[a])?i[a]=65535:1/0===e[a]?i[a]=31744:-1/0===e[a]?i[a]=64512:(o[0]=e[a],t=(r=f[0])>>>31<<15,n=(r<<1>>>24)-127,r=r>>13&1023,i[a]=n<-24?t:n<-14?t+(1024+r>>-14-n):15<n?31744+t:t+(15+n<<10)+r);return i}function se(e){return Array.isArray(e)||Oe(e)}function t(e){return"[object "+e+"]"}function ce(e){return Array.isArray(e)&&(0===e.length||"number"==typeof e[0])}function le(e){return!(!Array.isArray(e)||0===e.length||!se(e[0]))}function pe(e){return Object.prototype.toString.call(e)}function de(e){if(e){var t=pe(e);return 0<=u.indexOf(t)||(ce(e)||le(e)||ie(e))}}function he(e,t){36193===e.type?(e.data=ue(t),Ee.freeType(t)):e.data=t}function me(e,t,n,r,i,a){if(e=void 0!==c[e]?c[e]:Ie[e]*s[t],a&&(e*=6),i){for(r=0;1<=n;)r+=e*n*n,n/=2;return r}return e*n*r}function d(){this.w=this.z=this.y=this.x=this.state=0,this.buffer=null,this.size=0,this.normalized=!1,this.type=5126,this.divisor=this.stride=this.offset=0}function be(i,a,e,t,c,l,o){function n(){this.id=++r,this.attributes=[],this.elements=null,this.ownsElements=!1,this.offset=this.count=0,this.instances=-1,this.primitive=4;var e=a.oes_vertex_array_object;this.vao=e?e.createVertexArrayOES():null,(s[this.id]=this).buffers=[]}var f=e.maxAttributes,u=Array(f);for(e=0;e<f;++e)u[e]=new d;var r=0,s={},p={Record:d,scope:{},state:u,currentVAO:null,targetVAO:null,restore:a.oes_vertex_array_object?function(){a.oes_vertex_array_object&&De(s).forEach(function(e){e.refresh()})}:function(){},createVAO:function(e){function u(e){var t;Array.isArray(e)?(t=e,s.elements&&s.ownsElements&&s.elements.destroy(),s.elements=null,s.ownsElements=!1,s.offset=0,s.count=0,s.instances=-1,s.primitive=4):(e.elements?(t=e.elements,s.ownsElements?("function"==typeof t&&"elements"===t._reglType?s.elements.destroy():s.elements(t),s.ownsElements=!1):l.getElements(e.elements)?(s.elements=e.elements,s.ownsElements=!1):(s.elements=l.create(e.elements),s.ownsElements=!0)):(s.elements=null,s.ownsElements=!1),t=e.attributes,s.offset=0,s.count=-1,s.instances=-1,s.primitive=4,s.elements&&(s.count=s.elements._elements.vertCount,s.primitive=s.elements._elements.primType),"offset"in e&&(s.offset=0|e.offset),"count"in e&&(s.count=0|e.count),"instances"in e&&(s.instances=0|e.instances),"primitive"in e&&(s.primitive=Be[e.primitive])),e={};var n=s.attributes;n.length=t.length;for(var r=0;r<t.length;++r){var i,a=t[r],o=n[r]=new d,f=a.data||a;Array.isArray(f)||Oe(f)||ie(f)?(s.buffers[r]&&(i=s.buffers[r],Oe(f)&&i._buffer.byteLength>=f.byteLength?i.subdata(f):(i.destroy(),s.buffers[r]=null)),s.buffers[r]||(i=s.buffers[r]=c.create(a,34962,!1,!0)),o.buffer=c.getBuffer(i),o.size=0|o.buffer.dimension,o.normalized=!1,o.type=o.buffer.dtype,o.offset=0,o.stride=0,o.divisor=0,o.state=1,e[r]=1):c.getBuffer(a)?(o.buffer=c.getBuffer(a),o.size=0|o.buffer.dimension,o.normalized=!1,o.type=o.buffer.dtype,o.offset=0,o.stride=0,o.divisor=0,o.state=1):c.getBuffer(a.buffer)?(o.buffer=c.getBuffer(a.buffer),o.size=0|(+a.size||o.buffer.dimension),o.normalized=!!a.normalized||!1,o.type="type"in a?je[a.type]:o.buffer.dtype,o.offset=0|(a.offset||0),o.stride=0|(a.stride||0),o.divisor=0|(a.divisor||0),o.state=1):"x"in a&&(o.x=+a.x||0,o.y=+a.y||0,o.z=+a.z||0,o.w=+a.w||0,o.state=2)}for(i=0;i<s.buffers.length;++i)!e[i]&&s.buffers[i]&&(s.buffers[i].destroy(),s.buffers[i]=null);return s.refresh(),u}var s=new n;return t.vaoCount+=1,u.destroy=function(){for(var e=0;e<s.buffers.length;++e)s.buffers[e]&&s.buffers[e].destroy();s.buffers.length=0,s.ownsElements&&(s.elements.destroy(),s.elements=null,s.ownsElements=!1),s.destroy()},u._vao=s,u._reglType="vao",u(e)},getVAO:function(e){return"function"==typeof e&&e._vao?e._vao:null},destroyBuffer:function(e){for(var t=0;t<u.length;++t){var n=u[t];n.buffer===e&&(i.disableVertexAttribArray(t),n.buffer=null)}},setVAO:a.oes_vertex_array_object?function(e){var t;e!==p.currentVAO&&(t=a.oes_vertex_array_object,e?t.bindVertexArrayOES(e.vao):t.bindVertexArrayOES(null),p.currentVAO=e)}:function(e){if(e!==p.currentVAO){if(e)e.bindAttrs();else{for(var t=a.angle_instanced_arrays,n=0;n<u.length;++n){var r=u[n];r.buffer?(i.enableVertexAttribArray(n),r.buffer.bind(),i.vertexAttribPointer(n,r.size,r.type,r.normalized,r.stride,r.offfset),t&&r.divisor&&t.vertexAttribDivisorANGLE(n,r.divisor)):(i.disableVertexAttribArray(n),i.vertexAttrib4f(n,r.x,r.y,r.z,r.w))}o.elements?i.bindBuffer(34963,o.elements.buffer.buffer):i.bindBuffer(34963,null)}p.currentVAO=e}},clear:a.oes_vertex_array_object?function(){De(s).forEach(function(e){e.destroy()})}:function(){}};return n.prototype.bindAttrs=function(){for(var e=a.angle_instanced_arrays,t=this.attributes,n=0;n<t.length;++n){var r=t[n];r.buffer?(i.enableVertexAttribArray(n),i.bindBuffer(34962,r.buffer.buffer),i.vertexAttribPointer(n,r.size,r.type,r.normalized,r.stride,r.offset),e&&r.divisor&&e.vertexAttribDivisorANGLE(n,r.divisor)):(i.disableVertexAttribArray(n),i.vertexAttrib4f(n,r.x,r.y,r.z,r.w))}for(e=t.length;e<f;++e)i.disableVertexAttribArray(e);(e=l.getElements(this.elements))?i.bindBuffer(34963,e.buffer.buffer):i.bindBuffer(34963,null)},n.prototype.refresh=function(){var e=a.oes_vertex_array_object;e&&(e.bindVertexArrayOES(this.vao),this.bindAttrs(),p.currentVAO=this)},n.prototype.destroy=function(){var e;this.vao&&(e=a.oes_vertex_array_object,this===p.currentVAO&&(p.currentVAO=null,e.bindVertexArrayOES(null)),e.deleteVertexArrayOES(this.vao),this.vao=null),this.ownsElements&&(this.elements.destroy(),this.elements=null,this.ownsElements=!1),s[this.id]&&(delete s[this.id],--t.vaoCount)},p}function ve(f,u,s,c){function r(e){var t=null===u.next?5121:u.next.colorAttachments[0].texture._texture.type,n=0,r=0,i=c.framebufferWidth,a=c.framebufferHeight,o=null;return Oe(e)?o=e:e&&(n=0|e.x,r=0|e.y,i=0|(e.width||c.framebufferWidth-n),a=0|(e.height||c.framebufferHeight-r),o=e.data||null),s(),e=i*a*4,o||(5121===t?o=new Uint8Array(e):5126===t&&(o=o||new Float32Array(e))),f.pixelStorei(3333,4),f.readPixels(n,r,i,a,6408,t,o),o}return function(e){return e&&"framebuffer"in e?(t=e,u.setFBO({framebuffer:t.framebuffer},function(){n=r(t)}),n):r(e);var t,n}}function B(e){return Array.prototype.slice.call(e)}function P(e){return B(e).join("")}function $(e){return Array.isArray(e)||Oe(e)||ie(e)}function M(e){return e.sort(function(e,t){return"viewport"===e||"viewport"!==t&&e<t?-1:1})}function ee(e,t,n,r){this.thisDep=e,this.contextDep=t,this.propDep=n,this.append=r}function te(e){return e&&!(e.thisDep||e.contextDep||e.propDep)}function ne(e){return new ee(!1,!1,!1,e)}function ge(e,t){var n=e.type;if(0===n)return new ee(!0,1<=(n=e.data.length),2<=n,t);if(4===n)return new ee((n=e.data).thisDep,n.contextDep,n.propDep,t);if(5===n)return new ee(!1,!1,!1,t);if(6!==n)return new ee(3===n,2===n,1===n,t);for(var r=n=!1,i=!1,a=0;a<e.data.length;++a){var o=e.data[a];1===o.type?i=!0:2===o.type?r=!0:3===o.type?n=!0:0===o.type?(n=!0,1<=(o=o.data)&&(r=!0),2<=o&&(i=!0)):4===o.type&&(n=n||o.data.thisDep,r=r||o.data.contextDep,i=i||o.data.propDep)}return new ee(n,r,i,t)}function ye(e,H,W,a,q,U,t,N,n,Q,G,r,i,m,o){function Y(e){return e.replace(".","_")}function f(e,t,n){var r=Y(e);J.push(e),C[r]=T[r]=!!n,j[r]=t}function u(e,t,n){var r=Y(e);J.push(e),Array.isArray(n)?(T[r]=n.slice(),C[r]=n.slice()):T[r]=C[r]=n,z[r]=t}function d(){var r,n,i,a,o,f=(r=0,n=[],i=[],a=s(),o={},{global:a,link:function(e){for(var t=0;t<i.length;++t)if(i[t]===e)return n[t];return t="g"+r++,n.push(t),i.push(e),t},block:s,proc:function(e,t){function n(){var e="a"+r.length;return r.push(e),e}var r=[];t=t||0;for(var i=0;i<t;++i)n();var a=(i=c()).toString;return o[e]=we(i,{arg:n,toString:function(){return P(["function(",r.join(),"){",a(),"}"])}})},scope:c,cond:function(){var t=P(arguments),e=c(),n=c(),r=e.toString,i=n.toString;return we(e,{then:function(){return e.apply(e,B(arguments)),this},else:function(){return n.apply(n,B(arguments)),this},toString:function(){var e=(e=i())&&"else{"+e+"}";return P(["if(",t,"){",r(),"}",e])}})},compile:function(){var t=['"use strict";',a,"return {"];Object.keys(o).forEach(function(e){t.push('"',e,'":',o[e].toString(),",")}),t.push("}");var e=P(t).replace(/;/g,";\n").replace(/}/g,"}\n").replace(/{/g,"{\n");return Function.apply(null,n.concat(e)).apply(null,i)}}),u=f.link,t=f.global;function s(){var t=[],n=[];return we(function(){t.push.apply(t,B(arguments))},{def:function(){var e="v"+r++;return n.push(e),0<arguments.length&&(t.push(e,"="),t.push.apply(t,B(arguments)),t.push(";")),e},toString:function(){return P([0<n.length?"var "+n.join(",")+";":"",P(t)])}})}function c(){function r(e,t){n(e,t,"=",i.def(e,t),";")}var i=s(),n=s(),e=i.toString,t=n.toString;return we(function(){i.apply(i,B(arguments))},{def:i.def,entry:i,exit:n,save:r,set:function(e,t,n){r(e,t),i(e,t,"=",n,";")},toString:function(){return e()+t()}})}f.id=L++,f.batchId="0";var l=u(F),p=f.shared={props:"a0"};Object.keys(F).forEach(function(e){p[e]=t.def(l,".",e)});var d=f.next={},h=f.current={};Object.keys(z).forEach(function(e){Array.isArray(T[e])&&(d[e]=t.def(p.next,".",e),h[e]=t.def(p.current,".",e))});var m=f.constants={};Object.keys(V).forEach(function(e){m[e]=t.def(JSON.stringify(V[e]))}),f.invoke=function(t,e){switch(e.type){case 0:var n=["this",p.context,p.props,f.batchId];return t.def(u(e.data),".call(",n.slice(0,Math.max(e.data.length+1,4)),")");case 1:return t.def(p.props,e.data);case 2:return t.def(p.context,e.data);case 3:return t.def("this",e.data);case 4:return e.data.append(f,t),e.data.ref;case 5:return e.data.toString();case 6:return e.data.map(function(e){return f.invoke(t,e)})}},f.attribCache={};var b={};return f.scopeAttrib=function(e){if((e=H.id(e))in b)return b[e];var t=(t=Q.scope[e])||(Q.scope[e]=new K);return b[e]=u(t)},f}function s(e,t,n,r){function i(e){var t=x[e];t&&(A[e]=t)}var a,o,f,u,s,c,l,p,d,h,m,b,v,g=function(e,t){if("string"==typeof(n=e.static).frag&&"string"==typeof n.vert){if(0<Object.keys(t.dynamic).length)return null;var n=t.static,r=Object.keys(n);if(0<r.length&&"number"==typeof n[r[0]]){for(var i=[],a=0;a<r.length;++a)i.push([0|n[r[a]],r[a]]);return i}}return null}(e,t),y=function(e){var t=e.static,e=e.dynamic;if("framebuffer"in t){var r=t.framebuffer;return r?(r=N.getFramebuffer(r),ne(function(e,t){var n=e.link(r),e=e.shared;return t.set(e.framebuffer,".next",n),e=e.context,t.set(e,".framebufferWidth",n+".width"),t.set(e,".framebufferHeight",n+".height"),n})):ne(function(e,t){e=e.shared;return t.set(e.framebuffer,".next","null"),e=e.context,t.set(e,".framebufferWidth",e+".drawingBufferWidth"),t.set(e,".framebufferHeight",e+".drawingBufferHeight"),"null"})}if("framebuffer"in e){var i=e.framebuffer;return ge(i,function(e,t){var n=e.invoke(t,i),r=e.shared,e=r.framebuffer,n=t.def(e,".getFramebuffer(",n,")");return t.set(e,".next",n),r=r.context,t.set(r,".framebufferWidth",n+"?"+n+".width:"+r+".drawingBufferWidth"),t.set(r,".framebufferHeight",n+"?"+n+".height:"+r+".drawingBufferHeight"),n})}return null}(e),x=(h=y,b=(E=e).static,v=E.dynamic,(E=k("viewport"))&&(E=new ee((m=E).thisDep,E.contextDep,E.propDep,function(e,t){var n=m.append(e,t),e=e.shared.context;return t.set(e,".viewportWidth",n[2]),t.set(e,".viewportHeight",n[3]),n})),{viewport:E,scissor_box:k("scissor.box")}),w=function(e){function t(e,n){if(e in a){var r=0|a[e];return n?u.offset=r:u.instances=r,ne(function(e,t){return n&&(e.OFFSET=r),r})}if(e in f){var i=f[e];return ge(i,function(e,t){t=e.invoke(t,i);return n&&(e.OFFSET=t),t})}if(n){if(l)return ne(function(e,t){return e.OFFSET=0});if(s)return new ee(c.thisDep,c.contextDep,c.propDep,function(e,t){return t.def(e.shared.vao+".currentVAO?"+e.shared.vao+".currentVAO.offset:0")})}else if(s)return new ee(c.thisDep,c.contextDep,c.propDep,function(e,t){return t.def(e.shared.vao+".currentVAO?"+e.shared.vao+".currentVAO.instances:-1")});return null}var a=e.static,f=e.dynamic,u={},s=!1,c=function(){if("vao"in a){var n=a.vao;return null!==n&&null===Q.getVAO(n)&&(n=Q.createVAO(n)),s=!0,u.vao=n,ne(function(e){var t=Q.getVAO(n);return t?e.link(t):"null"})}if("vao"in f){s=!0;var r=f.vao;return ge(r,function(e,t){var n=e.invoke(t,r);return t.def(e.shared.vao+".getVAO("+n+")")})}return null}(),l=!1,i=function(){if("elements"in a){var e,r=a.elements;return $(u.elements=r)?(e=u.elements=U.create(r,!0),r=U.getElements(e),l=!0):r&&(r=U.getElements(r),l=!0),(e=ne(function(e,t){if(r){var n=e.link(r);return e.ELEMENTS=n}return e.ELEMENTS=null})).value=r,e}if("elements"in f){l=!0;var o=f.elements;return ge(o,function(e,t){var n=(r=e.shared).isBufferArgs,r=r.elements,i=e.invoke(t,o),a=t.def("null"),n=t.def(n,"(",i,")"),i=e.cond(n).then(a,"=",r,".createStream(",i,");").else(a,"=",r,".getElements(",i,");");return t.entry(i),t.exit(e.cond(n).then(r,".destroyStream(",a,");")),e.ELEMENTS=a})}return s?new ee(c.thisDep,c.contextDep,c.propDep,function(e,t){return t.def(e.shared.vao+".currentVAO?"+e.shared.elements+".getElements("+e.shared.vao+".currentVAO.elements):null")}):null}();l&&(c=ne(function(){return"null"}));var r=t("offset",!0),n=function(){if("primitive"in a){var n=a.primitive;return u.primitive=n,ne(function(e,t){return Be[n]})}if("primitive"in f){var r=f.primitive;return ge(r,function(e,t){var n=e.constants.primTypes,e=e.invoke(t,r);return t.def(n,"[",e,"]")})}return l?te(i)?i.value?ne(function(e,t){return t.def(e.ELEMENTS,".primType")}):ne(function(){return 4}):new ee(i.thisDep,i.contextDep,i.propDep,function(e,t){e=e.ELEMENTS;return t.def(e,"?",e,".primType:",4)}):s?new ee(c.thisDep,c.contextDep,c.propDep,function(e,t){return t.def(e.shared.vao+".currentVAO?"+e.shared.vao+".currentVAO.primitive:4")}):null}(),o=function(){if("count"in a){var e=0|a.count;return u.count=e,ne(function(){return e})}if("count"in f){var n=f.count;return ge(n,function(e,t){return e.invoke(t,n)})}return l?te(i)?i?r?new ee(r.thisDep,r.contextDep,r.propDep,function(e,t){return t.def(e.ELEMENTS,".vertCount-",e.OFFSET)}):ne(function(e,t){return t.def(e.ELEMENTS,".vertCount")}):ne(function(){return-1}):new ee(i.thisDep||r.thisDep,i.contextDep||r.contextDep,i.propDep||r.propDep,function(e,t){var n=e.ELEMENTS;return e.OFFSET?t.def(n,"?",n,".vertCount-",e.OFFSET,":-1"):t.def(n,"?",n,".vertCount:-1")}):s?new ee(c.thisDep,c.contextDep,c.propDep,function(e,t){return t.def(e.shared.vao,".currentVAO?",e.shared.vao,".currentVAO.count:-1")}):null}(),e=t("instances",!1);return{elements:i,primitive:n,count:o,instances:e,offset:r,vao:c,vaoActive:s,elementsActive:l,static:u}}(e),A=(l=(c=e).static,p=c.dynamic,d={},J.forEach(function(a){function e(e,n){var t,r;a in l?(t=e(l[a]),d[i]=ne(function(){return t})):a in p&&(r=p[a],d[i]=ge(r,function(e,t){return n(e,t,e.invoke(t,r))}))}var i=Y(a);switch(a){case"cull.enable":case"blend.enable":case"dither":case"stencil.enable":case"depth.enable":case"scissor.enable":case"polygonOffset.enable":case"sample.alpha":case"sample.enable":case"depth.mask":return e(function(e){return e},function(e,t,n){return n});case"depth.func":return e(function(e){return Je[e]},function(e,t,n){return t.def(e.constants.compareFuncs,"[",n,"]")});case"depth.range":return e(function(e){return e},function(e,t,n){return[t.def("+",n,"[0]"),t=t.def("+",n,"[1]")]});case"blend.func":return e(function(e){return[Xe["srcRGB"in e?e.srcRGB:e.src],Xe["dstRGB"in e?e.dstRGB:e.dst],Xe["srcAlpha"in e?e.srcAlpha:e.src],Xe["dstAlpha"in e?e.dstAlpha:e.dst]]},function(e,n,r){function t(e,t){return n.def('"',e,t,'" in ',r,"?",r,".",e,t,":",r,".",e)}e=e.constants.blendFuncs;var i=t("src","RGB"),a=t("dst","RGB"),i=n.def(e,"[",i,"]"),o=n.def(e,"[",t("src","Alpha"),"]");return[i,a=n.def(e,"[",a,"]"),o,e=n.def(e,"[",t("dst","Alpha"),"]")]});case"blend.equation":return e(function(e){return"string"==typeof e?[X[e],X[e]]:"object"==typeof e?[X[e.rgb],X[e.alpha]]:void 0},function(e,t,n){var r=e.constants.blendEquations,i=t.def(),a=t.def();return(e=e.cond("typeof ",n,'==="string"')).then(i,"=",a,"=",r,"[",n,"];"),e.else(i,"=",r,"[",n,".rgb];",a,"=",r,"[",n,".alpha];"),t(e),[i,a]});case"blend.color":return e(function(t){return Z(4,function(e){return+t[e]})},function(e,t,n){return Z(4,function(e){return t.def("+",n,"[",e,"]")})});case"stencil.mask":return e(function(e){return 0|e},function(e,t,n){return t.def(n,"|0")});case"stencil.func":return e(function(e){return[Je[e.cmp||"keep"],e.ref||0,"mask"in e?e.mask:-1]},function(e,t,n){return[e=t.def('"cmp" in ',n,"?",e.constants.compareFuncs,"[",n,".cmp]",":",7680),t.def(n,".ref|0"),t=t.def('"mask" in ',n,"?",n,".mask|0:-1")]});case"stencil.opFront":case"stencil.opBack":return e(function(e){return["stencil.opBack"===a?1029:1028,Ze[e.fail||"keep"],Ze[e.zfail||"keep"],Ze[e.zpass||"keep"]]},function(e,t,n){function r(e){return t.def('"',e,'" in ',n,"?",i,"[",n,".",e,"]:",7680)}var i=e.constants.stencilOps;return["stencil.opBack"===a?1029:1028,r("fail"),r("zfail"),r("zpass")]});case"polygonOffset.offset":return e(function(e){return[0|e.factor,0|e.units]},function(e,t,n){return[t.def(n,".factor|0"),t=t.def(n,".units|0")]});case"cull.face":return e(function(e){var t=0;return"front"===e?t=1028:"back"===e&&(t=1029),t},function(e,t,n){return t.def(n,'==="front"?',1028,":",1029)});case"lineWidth":return e(function(e){return e},function(e,t,n){return n});case"frontFace":return e(function(e){return $e[e]},function(e,t,n){return t.def(n+'==="cw"?2304:2305')});case"colorMask":return e(function(e){return e.map(function(e){return!!e})},function(e,t,n){return Z(4,function(e){return"!!"+n+"["+e+"]"})});case"sample.coverage":return e(function(e){return["value"in e?e.value:1,!!e.invert]},function(e,t,n){return[t.def('"value" in ',n,"?+",n,".value:1"),t=t.def("!!",n,".invert")]})}}),d),c=(R=g,a=(E=e).static,o=E.dynamic,f=_("frag"),u=_("vert"),s=null,E=te(f)&&te(u)?(s=G.program(u.id,f.id,null,R),ne(function(e,t){return e.link(s)})):new ee(f&&f.thisDep||u&&u.thisDep,f&&f.contextDep||u&&u.contextDep,f&&f.propDep||u&&u.propDep,function(e,t){var n=e.shared.shader,r=f?f.append(e,t):t.def(n,".","frag"),e=u?u.append(e,t):t.def(n,".","vert");return t.def(n+".program("+e+","+r+")")}),{frag:f,vert:u,progVar:E,program:s});function _(e){if(e in a){var t=H.id(a[e]);return(e=ne(function(){return t})).id=t,e}if(e in o){var r=o[e];return ge(r,function(e,t){var n=e.invoke(t,r);return t.def(e.shared.strings,".id(",n,")")})}return null}function k(e){if(e in b){var i=b[e];e=!0;var a,o,f=0|i.x,u=0|i.y;return"width"in i?a=0|i.width:e=!1,"height"in i?o=0|i.height:e=!1,new ee(!e&&h&&h.thisDep,!e&&h&&h.contextDep,!e&&h&&h.propDep,function(e,t){var n=e.shared.context,r=a;"width"in i||(r=t.def(n,".","framebufferWidth","-",f));e=o;return"height"in i||(e=t.def(n,".","framebufferHeight","-",u)),[f,u,r,e]})}if(e in v){var s=v[e];return e=ge(s,function(e,t){var n=e.invoke(t,s),r=e.shared.context,i=t.def(n,".x|0"),e=t.def(n,".y|0");return[i,e,t.def('"width" in ',n,"?",n,".width|0:","(",r,".","framebufferWidth","-",i,")"),n=t.def('"height" in ',n,"?",n,".height|0:","(",r,".","framebufferHeight","-",e,")")]}),h&&(e.thisDep=e.thisDep||h.thisDep,e.contextDep=e.contextDep||h.contextDep,e.propDep=e.propDep||h.propDep),e}return h?new ee(h.thisDep,h.contextDep,h.propDep,function(e,t){e=e.shared.context;return[0,0,t.def(e,".","framebufferWidth"),t.def(e,".","framebufferHeight")]}):null}i("viewport"),i(Y("scissor.box"));var E,D,O,S,T,C,j,z,F,V,L,B,P,M,I,R=0<Object.keys(A).length;return(y={framebuffer:y,draw:w,shader:c,state:A,dirty:R,scopeVAO:null,drawVAO:null,useVAO:!1,attributes:{}}).profile=(R=(E=e).static,E=E.dynamic,"profile"in R?(D=!!R.profile,(O=ne(function(e,t){return D})).enable=D):"profile"in E&&(O=ge(S=E.profile,function(e,t){return e.invoke(t,S)})),O),y.uniforms=(T=(n=n).static,C=n.dynamic,j={},Object.keys(T).forEach(function(e){var t,n,r=T[e];"number"==typeof r||"boolean"==typeof r?t=ne(function(){return r}):"function"==typeof r?"texture2d"===(n=r._reglType)||"textureCube"===n?t=ne(function(e){return e.link(r)}):"framebuffer"!==n&&"framebufferCube"!==n||(t=ne(function(e){return e.link(r.color[0])})):se(r)&&(t=ne(function(e){return e.global.def("[",Z(r.length,function(e){return r[e]}),"]")})),t.value=r,j[e]=t}),Object.keys(C).forEach(function(e){var n=C[e];j[e]=ge(n,function(e,t){return e.invoke(t,n)})}),j),y.drawVAO=y.scopeVAO=w.vao,!y.drawVAO&&c.program&&!g&&W.angle_instanced_arrays&&w.static.elements&&(z=!0,e=c.program.attributes.map(function(e){return e=t.static[e],z=z&&!!e,e}),z&&0<e.length&&(F=Q.getVAO(Q.createVAO({attributes:e,elements:w.static.elements})),y.drawVAO=new ee(null,null,null,function(e,t){return e.link(F)}),y.useVAO=!0)),g?y.useVAO=!0:y.attributes=(V=(g=t).static,L=g.dynamic,B={},Object.keys(V).forEach(function(e){var n,t,r,i,a,o,f,u=V[e],s=H.id(e),c=new K;$(u)?(c.state=1,c.buffer=q.getBuffer(q.create(u,34962,!1,!0)),c.type=0):(t=q.getBuffer(u))?(c.state=1,c.buffer=t,c.type=0):"constant"in u?(n=u.constant,c.buffer="null",c.state=2,"number"==typeof n?c.x=n:Ke.forEach(function(e,t){t<n.length&&(c[e]=n[t])})):(t=$(u.buffer)?q.getBuffer(q.create(u.buffer,34962,!1,!0)):q.getBuffer(u.buffer),r=0|u.offset,i=0|u.stride,a=0|u.size,o=!!u.normalized,f=0,"type"in u&&(f=je[u.type]),u=0|u.divisor,c.buffer=t,c.state=1,c.size=a,c.normalized=o,c.type=f||t.dtype,c.offset=r,c.stride=i,c.divisor=u),B[e]=ne(function(e,t){var n=e.attribCache;if(s in n)return n[s];var r={isStream:!1};return Object.keys(c).forEach(function(e){r[e]=c[e]}),c.buffer&&(r.buffer=e.link(c.buffer),r.type=r.type||r.buffer+".dtype"),n[s]=r})}),Object.keys(L).forEach(function(e){var c=L[e];B[e]=ge(c,function(e,t){function n(e){t(f[e],"=",r,".",e,"|0;")}var r=e.invoke(t,c),i=e.shared,a=e.constants,o=i.isBufferArgs,i=i.buffer,f={isStream:t.def(!1)},u=new K;u.state=1,Object.keys(u).forEach(function(e){f[e]=t.def(""+u[e])});var s=f.buffer,e=f.type;return t("if(",o,"(",r,")){",f.isStream,"=true;",s,"=",i,".createStream(",34962,",",r,");",e,"=",s,".dtype;","}else{",s,"=",i,".getBuffer(",r,");","if(",s,"){",e,"=",s,".dtype;",'}else if("constant" in ',r,"){",f.state,"=",2,";","if(typeof "+r+'.constant === "number"){',f[Ke[0]],"=",r,".constant;",Ke.slice(1).map(function(e){return f[e]}).join("="),"=0;","}else{",Ke.map(function(e,t){return f[e]+"="+r+".constant.length>"+t+"?"+r+".constant["+t+"]:0;"}).join(""),"}}else{","if(",o,"(",r,".buffer)){",s,"=",i,".createStream(",34962,",",r,".buffer);","}else{",s,"=",i,".getBuffer(",r,".buffer);","}",e,'="type" in ',r,"?",a.glTypes,"[",r,".type]:",s,".dtype;",f.normalized,"=!!",r,".normalized;"),n("size"),n("offset"),n("stride"),n("divisor"),t("}}"),t.exit("if(",f.isStream,"){",i,".destroyStream(",s,");","}"),f})}),B),y.context=(P=(r=r).static,M=r.dynamic,I={},Object.keys(P).forEach(function(e){var n=P[e];I[e]=ne(function(e,t){return"number"==typeof n||"boolean"==typeof n?""+n:e.link(n)})}),Object.keys(M).forEach(function(e){var n=M[e];I[e]=ge(n,function(e,t){return e.invoke(t,n)})}),I),y}function l(n,r,i){var a=n.shared.context,o=n.scope();Object.keys(i).forEach(function(e){r.save(a,"."+e);var t=i[e].append(n,r);Array.isArray(t)?o(a,".",e,"=[",t.join(),"];"):o(a,".",e,"=",t,";")}),r(o)}function h(e,t,n,r){var i,a=(f=e.shared).gl,o=f.framebuffer;O&&(i=t.def(f.extensions,".webgl_draw_buffers"));var f=(u=e.constants).drawBuffer,u=u.backBuffer;e=n?n.append(e,t):t.def(o,".next"),r||t("if(",e,"!==",o,".cur){"),t("if(",e,"){",a,".bindFramebuffer(",36160,",",e,".framebuffer);"),O&&t(i,".drawBuffersWEBGL(",f,"[",e,".colorAttachments.length]);"),t("}else{",a,".bindFramebuffer(",36160,",null);"),O&&t(i,".drawBuffersWEBGL(",u,");"),t("}",o,".cur=",e,";"),r||t("}")}function c(i,e,a){var t=i.shared,o=t.gl,f=i.current,u=i.next,s=t.current,c=t.next,l=i.cond(s,".dirty");J.forEach(function(e){var t,n,r;(e=Y(e))in a.state||(e in u?(t=u[e],n=f[e],r=Z(T[e].length,function(e){return l.def(t,"[",e,"]")}),l(i.cond(r.map(function(e,t){return e+"!=="+n+"["+t+"]"}).join("||")).then(o,".",z[e],"(",r,");",r.map(function(e,t){return n+"["+t+"]="+e}).join(";"),";"))):(t=l.def(c,".",e),r=i.cond(t,"!==",s,".",e),l(r),e in j?r(i.cond(t).then(o,".enable(",j[e],");").else(o,".disable(",j[e],");"),s,".",e,"=",t,";"):r(o,".",z[e],"(",t,");",s,".",e,"=",t,";")))}),0===Object.keys(a.state).length&&l(s,".dirty=false;"),e(l)}function p(a,o,f,u){var e=a.shared,s=a.current,c=e.current,l=e.gl;M(Object.keys(f)).forEach(function(e){var t,n,r,i=f[e];u&&!u(i)||(t=i.append(a,o),j[e]?(n=j[e],te(i)?o(l,t?".enable(":".disable(",n,");"):o(a.cond(t).then(l,".enable(",n,");").else(l,".disable(",n,");")),o(c,".",e,"=",t,";")):se(t)?(r=s[e],o(l,".",z[e],"(",t,");",t.map(function(e,t){return r+"["+t+"]="+e}).join(";"),";")):o(l,".",z[e],"(",t,");",c,".",e,"=",t,";"))})}function b(e,t){D&&(e.instancing=t.def(e.shared.extensions,".angle_instanced_arrays"))}function v(e,n,t,r,i){function a(){return"undefined"==typeof performance?"Date.now()":"performance.now()"}function o(e){e(s=n.def(),"=",a(),";"),"string"==typeof i?e(p,".count+=",i,";"):e(p,".count++;"),m&&(r?e(c=n.def(),"=",h,".getNumPendingQueries();"):e(h,".beginQuery(",p,");"))}function f(e){e(p,".cpuTime+=",a(),"-",s,";"),m&&(r?e(h,".pushScopeStats(",c,",",h,".getNumPendingQueries(),",p,");"):e(h,".endQuery();"))}function u(e){var t=n.def(d,".profile");n(d,".profile=",e,";"),n.exit(d,".profile=",t,";")}var s,c,l=e.shared,p=e.stats,d=l.current,h=l.timer;if(t=t.profile){if(te(t))return void(t.enable?(o(n),f(n.exit),u("true")):u("false"));u(t=t.append(e,n))}else t=n.def(d,".profile");o(l=e.block()),n("if(",t,"){",l,"}"),f(e=e.block()),n.exit("if(",t,"){",e,"}")}function g(l,p,a,e,o){var d=l.shared;e.forEach(function(e){var t=e.name,n=a.attributes[t];if(n){if(!o(n))return;i=n.append(l,p)}else{if(!o(R))return;var r=l.scopeAttrib(t),i={};Object.keys(new K).forEach(function(e){i[e]=p.def(r,".",e)})}!function(e,n,r){function t(){p("if(!",f,".buffer){",a,".enableVertexAttribArray(",o,");}");var e=r.type,t=r.size?p.def(r.size,"||",n):n;p("if(",f,".type!==",e,"||",f,".size!==",t,"||",c.map(function(e){return f+"."+e+"!=="+r[e]}).join("||"),"){",a,".bindBuffer(",34962,",",u,".buffer);",a,".vertexAttribPointer(",[o,t,e,r.normalized,r.stride,r.offset],");",f,".type=",e,";",f,".size=",t,";",c.map(function(e){return f+"."+e+"="+r[e]+";"}).join(""),"}"),D&&(e=r.divisor,p("if(",f,".divisor!==",e,"){",l.instancing,".vertexAttribDivisorANGLE(",[o,e],");",f,".divisor=",e,";}"))}function i(){p("if(",f,".buffer){",a,".disableVertexAttribArray(",o,");",f,".buffer=null;","}if(",Ke.map(function(e,t){return f+"."+e+"!=="+s[t]}).join("||"),"){",a,".vertexAttrib4f(",o,",",s,");",Ke.map(function(e,t){return f+"."+e+"="+s[t]+";"}).join(""),"}")}var a=d.gl,o=p.def(e,".location"),f=p.def(d.attributes,"[",o,"]");e=r.state;var u=r.buffer,s=[r.x,r.y,r.z,r.w],c=["buffer","normalized","offset","stride"];1===e?t():2===e?i():(p("if(",e,"===",1,"){"),t(),p("}else{"),i(),p("}"))}(l.link(e),function(e){switch(e){case 35664:case 35667:case 35671:return 2;case 35665:case 35668:case 35672:return 3;case 35666:case 35669:case 35673:return 4;default:return 1}}(e.info.type),i)})}function y(e,t,n,r,i,a){for(var o,f=e.shared,u=f.gl,s=0;s<r.length;++s){var c,l=(h=r[s]).name,p=h.info.type,d=n.uniforms[l],h=e.link(h)+".location";if(d){if(!i(d))continue;if(te(d)){if(l=d.value,35678===p||35680===p)t(u,".uniform1i(",h,",",(p=e.link(l._texture||l.color[0]._texture))+".bind());"),t.exit(p,".unbind();");else if(35674===p||35675===p||35676===p)d=2,35675===p?d=3:35676===p&&(d=4),t(u,".uniformMatrix",d,"fv(",h,",false,",l=e.global.def("new Float32Array(["+Array.prototype.slice.call(l)+"])"),");");else{switch(p){case 5126:o="1f";break;case 35664:o="2f";break;case 35665:o="3f";break;case 35666:o="4f";break;case 35670:case 5124:o="1i";break;case 35671:case 35667:o="2i";break;case 35672:case 35668:o="3i";break;case 35673:o="4i";break;case 35669:o="4i"}t(u,".uniform",o,"(",h,",",se(l)?Array.prototype.slice.call(l):l,");")}continue}c=d.append(e,t)}else{if(!i(R))continue;c=t.def(f.uniforms,"[",H.id(l),"]")}switch(35678===p?t("if(",c,"&&",c,'._reglType==="framebuffer"){',c,"=",c,".color[0];","}"):35680===p&&t("if(",c,"&&",c,'._reglType==="framebufferCube"){',c,"=",c,".color[0];","}"),l=1,p){case 35678:case 35680:p=t.def(c,"._texture"),t(u,".uniform1i(",h,",",p,".bind());"),t.exit(p,".unbind();");continue;case 5124:case 35670:o="1i";break;case 35667:case 35671:o="2i",l=2;break;case 35668:case 35672:o="3i",l=3;break;case 35669:case 35673:o="4i",l=4;break;case 5126:o="1f";break;case 35664:o="2f",l=2;break;case 35665:o="3f",l=3;break;case 35666:o="4f",l=4;break;case 35674:o="Matrix2fv";break;case 35675:o="Matrix3fv";break;case 35676:o="Matrix4fv"}if("M"===o.charAt(0)){t(u,".uniform",o,"(",h,",");var h=Math.pow(p-35674+2,2),m=e.global.def("new Float32Array(",h,")");Array.isArray(c)?t("false,(",Z(h,function(e){return m+"["+e+"]="+c[e]}),",",m,")"):t("false,(Array.isArray(",c,")||",c," instanceof Float32Array)?",c,":(",Z(h,function(e){return m+"["+e+"]="+c+"["+e+"]"}),",",m,")"),t(");")}else{if(1<l){for(var p=[],b=[],d=0;d<l;++d)Array.isArray(c)?b.push(c[d]):b.push(t.def(c+"["+d+"]")),a&&p.push(t.def());a&&t("if(!",e.batchId,"||",p.map(function(e,t){return e+"!=="+b[t]}).join("||"),"){",p.map(function(e,t){return e+"="+b[t]+";"}).join("")),t(u,".uniform",o,"(",h,",",b.join(","),");")}else a&&(p=t.def(),t("if(!",e.batchId,"||",p,"!==",c,"){",p,"=",c,";")),t(u,".uniform",o,"(",h,",",c,");");a&&t("}")}}}function x(n,r,i,a){function e(e){var t=h[e];return t?t.contextDep&&a.contextDynamic||t.propDep?t.append(n,i):t.append(n,r):r.def(d,".",e)}function t(){function e(){i(c,".drawElementsInstancedANGLE(",[b,g,y,v+"<<(("+y+"-5121)>>1)",s],");")}function t(){i(c,".drawArraysInstancedANGLE(",[b,v,g,s],");")}m&&"null"!==m?x?e():(i("if(",m,"){"),e(),i("}else{"),t(),i("}")):t()}function o(){function e(){i(p+".drawElements("+[b,g,y,v+"<<(("+y+"-5121)>>1)"]+");")}function t(){i(p+".drawArrays("+[b,v,g]+");")}m&&"null"!==m?x?e():(i("if(",m,"){"),e(),i("}else{"),t(),i("}")):t()}var f,u,s,c,l=n.shared,p=l.gl,d=l.draw,h=a.draw,m=(f=h.elements,u=r,f?((f.contextDep&&a.contextDynamic||f.propDep)&&(u=i),h.vaoActive?f=f.append(n,u):u("if("+(f=f.append(n,u))+")"+p+".bindBuffer(34963,"+f+".buffer.buffer);")):(f=u.def(),u("if(",l.vao,".currentVAO){",f,"=",n.shared.elements+".getElements("+l.vao,".currentVAO.elements);",S?"":"if("+f+")"+p+".bindBuffer(34963,"+f+".buffer.buffer);","}else{",f,"=",d,".","elements",";","if(",f,"){",p,".bindBuffer(",34963,",",f,".buffer.buffer);}}")),f),b=e("primitive"),v=e("offset"),g=(l=h.count,f=r,l=l?((l.contextDep&&a.contextDynamic||l.propDep)&&(f=i),l.append(n,f)):f.def(d,".","count"));if("number"==typeof g){if(0===g)return}else i("if(",g,"){"),i.exit("}");D&&(s=e("instances"),c=n.instancing);var y=m+".type",x=h.elements&&te(h.elements)&&!h.vaoActive;D&&("number"!=typeof s||0<=s)?"string"==typeof s?(i("if(",s,">0){"),t(),i("}else if(",s,"<0){"),o(),i("}")):t():o()}function w(e,t,n,r,i){return i=(t=d()).proc("body",i),D&&(t.instancing=i.def(t.shared.extensions,".angle_instanced_arrays")),e(t,i,n,r),t.compile().body}function A(e,t,n,r){b(e,t),n.useVAO?n.drawVAO?t(e.shared.vao,".setVAO(",n.drawVAO.append(e,t),");"):t(e.shared.vao,".setVAO(",e.shared.vao,".targetVAO);"):(t(e.shared.vao,".setVAO(null);"),g(e,t,n,r.attributes,function(){return 1})),y(e,t,n,r.uniforms,function(){return 1},!1),x(e,t,t,n)}function _(e,t,n,r){function i(){return!0}e.batchId="a1",b(e,t),g(e,t,n,r.attributes,i),y(e,t,n,r.uniforms,i,!1),x(e,t,t,n)}function k(t,e,n,r){function i(e){return e.contextDep&&o||e.propDep}function a(e){return!i(e)}b(t,e);var o=n.contextDep,f=e.def(),u=e.def();t.shared.props=u,t.batchId=f;var s=t.scope(),c=t.scope();e(s.entry,"for(",f,"=0;",f,"<","a1",";++",f,"){",u,"=","a0","[",f,"];",c,"}",s.exit),n.needsContext&&l(t,c,n.context),n.needsFramebuffer&&h(t,c,n.framebuffer),p(t,c,n.state,i),n.profile&&i(n.profile)&&v(t,c,n,!1,!0),r?(n.useVAO?n.drawVAO?i(n.drawVAO)?c(t.shared.vao,".setVAO(",n.drawVAO.append(t,c),");"):s(t.shared.vao,".setVAO(",n.drawVAO.append(t,s),");"):s(t.shared.vao,".setVAO(",t.shared.vao,".targetVAO);"):(s(t.shared.vao,".setVAO(null);"),g(t,s,n,r.attributes,a),g(t,c,n,r.attributes,i)),y(t,s,n,r.uniforms,a,!1),y(t,c,n,r.uniforms,i,!0),x(t,s,c,n)):(e=t.global.def("{}"),r=n.shader.progVar.append(t,c),u=c.def(r,".id"),s=c.def(e,"[",u,"]"),c(t.shared.gl,".useProgram(",r,".program);","if(!",s,"){",s,"=",e,"[",u,"]=",t.link(function(e){return w(_,t,n,e,2)}),"(",r,");}",s,".call(this,a0[",f,"],",f,");"))}function E(n,e,t){var r,i,a,o,f,u,s=e.static[t];s&&function(e){if("object"==typeof e&&!se(e))for(var t=Object.keys(e),n=0;n<t.length;++n)if(Ae.isDynamic(e[t[n]]))return 1}(s)&&(r=n.global,i=Object.keys(s),f=o=a=!1,u=n.global.def("{}"),i.forEach(function(e){var t=s[e];if(Ae.isDynamic(t))"function"==typeof t&&(t=s[e]=Ae.unbox(t)),e=ge(t,null),a=a||e.thisDep,f=f||e.propDep,o=o||e.contextDep;else{switch(r(u,".",e,"="),typeof t){case"number":r(t);break;case"string":r('"',t,'"');break;case"object":Array.isArray(t)&&r("[",t.join(),"]");break;default:r(n.link(t))}r(";")}}),e.dynamic[t]=new Ae.DynamicVariable(4,{thisDep:a,contextDep:o,propDep:f,ref:u,append:function(n,r){i.forEach(function(e){var t=s[e];Ae.isDynamic(t)&&(t=n.invoke(r,t),r(u,".",e,"=",t,";"))})}}),delete e.static[t])}var K=Q.Record,X={add:32774,subtract:32778,"reverse subtract":32779};W.ext_blend_minmax&&(X.min=32775,X.max=32776);var D=W.angle_instanced_arrays,O=W.webgl_draw_buffers,S=W.oes_vertex_array_object,T={dirty:!0,profile:o.profile},C={},J=[],j={},z={};f("dither",3024),f("blend.enable",3042),u("blend.color","blendColor",[0,0,0,0]),u("blend.equation","blendEquationSeparate",[32774,32774]),u("blend.func","blendFuncSeparate",[1,0,1,0]),f("depth.enable",2929,!0),u("depth.func","depthFunc",513),u("depth.range","depthRange",[0,1]),u("depth.mask","depthMask",!0),u("colorMask","colorMask",[!0,!0,!0,!0]),f("cull.enable",2884),u("cull.face","cullFace",1029),u("frontFace","frontFace",2305),u("lineWidth","lineWidth",1),f("polygonOffset.enable",32823),u("polygonOffset.offset","polygonOffset",[0,0]),f("sample.alpha",32926),f("sample.enable",32928),u("sample.coverage","sampleCoverage",[1,!1]),f("stencil.enable",2960),u("stencil.mask","stencilMask",-1),u("stencil.func","stencilFunc",[519,0,-1]),u("stencil.opFront","stencilOpSeparate",[1028,7680,7680,7680]),u("stencil.opBack","stencilOpSeparate",[1029,7680,7680,7680]),f("scissor.enable",3089),u("scissor.box","scissor",[0,0,e.drawingBufferWidth,e.drawingBufferHeight]),u("viewport","viewport",[0,0,e.drawingBufferWidth,e.drawingBufferHeight]);var F={gl:e,context:i,strings:H,next:C,current:T,draw:r,elements:U,buffer:q,shader:G,attributes:Q.state,vao:Q,uniforms:n,framebuffer:N,extensions:W,timer:m,isBufferArgs:$},V={primTypes:Be,compareFuncs:Je,blendFuncs:Xe,blendEquations:X,stencilOps:Ze,glTypes:je,orientationType:$e};O&&(V.backBuffer=[1029],V.drawBuffer=Z(a.maxDrawbuffers,function(e){return 0===e?[0]:Z(e,function(e){return 36064+e})}));var L=0;return{next:C,current:T,procs:function(){var o=d(),f=o.proc("poll"),u=o.proc("refresh"),s=o.block();f(s),u(s);var e,t=o.shared,c=t.gl,l=t.next,p=t.current;s(p,".dirty=false;"),h(o,f),h(o,u,null,!0),D&&(e=o.link(D)),W.oes_vertex_array_object&&u(o.link(W.oes_vertex_array_object),".bindVertexArrayOES(null);");for(var n=0;n<a.maxAttributes;++n){var r=u.def(t.attributes,"[",n,"]"),i=o.cond(r,".buffer");i.then(c,".enableVertexAttribArray(",n,");",c,".bindBuffer(",34962,",",r,".buffer.buffer);",c,".vertexAttribPointer(",n,",",r,".size,",r,".type,",r,".normalized,",r,".stride,",r,".offset);").else(c,".disableVertexAttribArray(",n,");",c,".vertexAttrib4f(",n,",",r,".x,",r,".y,",r,".z,",r,".w);",r,".buffer=null;"),u(i),D&&u(e,".vertexAttribDivisorANGLE(",n,",",r,".divisor);")}return u(o.shared.vao,".currentVAO=null;",o.shared.vao,".setVAO(",o.shared.vao,".targetVAO);"),Object.keys(j).forEach(function(e){var t=j[e],n=s.def(l,".",e),r=o.block();r("if(",n,"){",c,".enable(",t,")}else{",c,".disable(",t,")}",p,".",e,"=",n,";"),u(r),f("if(",n,"!==",p,".",e,"){",r,"}")}),Object.keys(z).forEach(function(e){var t,n,r=z[e],i=T[e],a=o.block();a(c,".",r,"("),se(i)?(r=i.length,t=o.global.def(l,".",e),n=o.global.def(p,".",e),a(Z(r,function(e){return t+"["+e+"]"}),");",Z(r,function(e){return n+"["+e+"]="+t+"["+e+"];"}).join("")),f("if(",Z(r,function(e){return t+"["+e+"]!=="+n+"["+e+"]"}).join("||"),"){",a,"}")):(t=s.def(l,".",e),n=s.def(p,".",e),a(t,");",p,".",e,"=",t,";"),f("if(",t,"!==",n,"){",a,"}")),u(a)}),o.compile()}(),compile:function(t,n,e,r,i){var a=d();a.stats=a.link(i),Object.keys(n.static).forEach(function(e){E(a,n,e)}),I.forEach(function(e){E(a,t,e)});var o=s(t,n,e,r);return function(t,n){var e=t.proc("draw",1);b(t,e),l(t,e,n.context),h(t,e,n.framebuffer),c(t,e,n),p(t,e,n.state),v(t,e,n,!1,!0);var r,i,a,o=n.shader.progVar.append(t,e);e(t.shared.gl,".useProgram(",o,".program);"),n.shader.program?A(t,e,n,n.shader.program):(e(t.shared.vao,".setVAO(null);"),r=t.global.def("{}"),i=e.def(o,".id"),a=e.def(r,"[",i,"]"),e(t.cond(a).then(a,".call(this,a0);").else(a,"=",r,"[",i,"]=",t.link(function(e){return w(A,t,n,e,1)}),"(",o,");",a,".call(this,a0);"))),0<Object.keys(n.state).length&&e(t.shared.current,".dirty=true;")}(a,o),function(r,i){function e(e){var t=i.shader[e];t&&a.set(o.shader,"."+e,t.append(r,a))}var a=r.proc("scope",3);r.batchId="a2";var o=r.shared,t=o.current;l(r,a,i.context),i.framebuffer&&i.framebuffer.append(r,a),M(Object.keys(i.state)).forEach(function(n){var e=i.state[n].append(r,a);se(e)?e.forEach(function(e,t){a.set(r.next[n],"["+t+"]",e)}):a.set(o.next,"."+n,e)}),v(r,a,i,!0,!0),["elements","offset","count","instances","primitive"].forEach(function(e){var t=i.draw[e];t&&a.set(o.draw,"."+e,""+t.append(r,a))}),Object.keys(i.uniforms).forEach(function(e){var t=i.uniforms[e].append(r,a);Array.isArray(t)&&(t="["+t.join()+"]"),a.set(o.uniforms,"["+H.id(e)+"]",t)}),Object.keys(i.attributes).forEach(function(e){var t=i.attributes[e].append(r,a),n=r.scopeAttrib(e);Object.keys(new K).forEach(function(e){a.set(n,"."+e,t[e])})}),i.scopeVAO&&a.set(o.vao,".targetVAO",i.scopeVAO.append(r,a)),e("vert"),e("frag"),0<Object.keys(i.state).length&&(a(t,".dirty=true;"),a.exit(t,".dirty=true;")),a("a1(",r.shared.context,",a0,",r.batchId,");")}(a,o),function(t,n){function r(e){return e.contextDep&&i||e.propDep}var e=t.proc("batch",2);t.batchId="0",b(t,e);var i=!1,a=!0;Object.keys(n.context).forEach(function(e){i=i||n.context[e].propDep}),i||(l(t,e,n.context),a=!1);var o,f=n.framebuffer,u=!1;f?(f.propDep?i=u=!0:f.contextDep&&i&&(u=!0),u||h(t,e,f)):h(t,e,null),n.state.viewport&&n.state.viewport.propDep&&(i=!0),c(t,e,n),p(t,e,n.state,function(e){return!r(e)}),n.profile&&r(n.profile)||v(t,e,n,!1,"a1"),n.contextDep=i,n.needsContext=a,n.needsFramebuffer=u,(a=n.shader.progVar).contextDep&&i||a.propDep?k(t,e,n,null):(a=a.append(t,e),e(t.shared.gl,".useProgram(",a,".program);"),n.shader.program?k(t,e,n,n.shader.program):(e(t.shared.vao,".setVAO(null);"),f=t.global.def("{}"),u=e.def(a,".id"),o=e.def(f,"[",u,"]"),e(t.cond(o).then(o,".call(this,a0,a1);").else(o,"=",f,"[",u,"]=",t.link(function(e){return w(k,t,n,e,2)}),"(",a,");",o,".call(this,a0,a1);")))),0<Object.keys(n.state).length&&e(t.shared.current,".dirty=true;")}(a,o),we(a.compile(),{destroy:function(){o.shader.program.destroy()}})}}}function xe(e,t){for(var n=0;n<e.length;++n)if(e[n]===t)return n;return-1}var we=function(e,t){for(var n=Object.keys(t),r=0;r<n.length;++r)e[n[r]]=t[n[r]];return e},r=0,Ae={DynamicVariable:i,define:function(e,t){return new i(e,n(t+""))},isDynamic:function(e){return"function"==typeof e&&!e._reglType||e instanceof i},unbox:function n(e,r){return"function"==typeof e?new i(0,e):"number"==typeof e||"boolean"==typeof e?new i(5,e):Array.isArray(e)?new i(6,e.map(function(e,t){return n(e,r+"["+t+"]")})):e instanceof i?e:void 0},accessor:n},_e={next:"function"==typeof requestAnimationFrame?function(e){return requestAnimationFrame(e)}:function(e){return setTimeout(e,16)},cancel:"function"==typeof cancelAnimationFrame?function(e){return cancelAnimationFrame(e)}:clearTimeout},ke="undefined"!=typeof performance&&performance.now?function(){return performance.now()}:function(){return+new Date},Ee=e();Ee.zero=e();function De(t){return Object.keys(t).map(function(e){return t[e]})}var Oe=function(e){return e instanceof Uint8Array||e instanceof Uint16Array||e instanceof Uint32Array||e instanceof Int8Array||e instanceof Int16Array||e instanceof Int32Array||e instanceof Float32Array||e instanceof Float64Array||e instanceof Uint8ClampedArray},Se=function(e){for(var t=[];e.length;e=e[0])t.push(e.length);return t},Te=function(e,t,n,r){var i=1;if(t.length)for(var a=0;a<t.length;++a)i*=t[a];else i=0;switch(n=r||Ee.allocType(n,i),t.length){case 0:break;case 1:for(r=t[0],t=0;t<r;++t)n[t]=e[t];break;case 2:for(r=t[0],t=t[1],a=i=0;a<r;++a)for(var o=e[a],f=0;f<t;++f)n[i++]=o[f];break;case 3:l(e,t[0],t[1],t[2],n,0);break;default:!function e(t,n,r,i,a){for(var o=1,f=r+1;f<n.length;++f)o*=n[f];var u=n[r];if(4==n.length-r){var s=n[r+1],c=n[r+2];for(n=n[r+3],f=0;f<u;++f)l(t[f],s,c,n,i,a),a+=o}else for(f=0;f<u;++f)e(t[f],n,r+1,i,a),a+=o}(e,t,0,n,0)}return n},Ce={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121},je={int8:5120,int16:5122,int32:5124,uint8:5121,uint16:5123,uint32:5125,float:5126,float32:5126},ze={dynamic:35048,stream:35040,static:35044},Fe=Te,Ve=Se,Le=[];Le[5120]=1,Le[5122]=2,Le[5124]=4,Le[5121]=1,Le[5123]=2,Le[5125]=4;var Be={points:0,point:0,lines:1,line:1,triangles:Le[5126]=4,triangle:4,"line loop":2,"line strip":3,"triangle strip":5,"triangle fan":6},o=new Float32Array(1),f=new Uint32Array(o.buffer),Pe=[9984,9986,9985,9987],Me=[0,6409,6410,6407,6408],Ie={};Ie[6409]=Ie[6406]=Ie[6402]=1,Ie[34041]=Ie[6410]=2,Ie[6407]=Ie[35904]=3,Ie[6408]=Ie[35906]=4;var Re=t("HTMLCanvasElement"),He=t("OffscreenCanvas"),We=t("CanvasRenderingContext2D"),qe=t("ImageBitmap"),Ue=t("HTMLImageElement"),Ne=t("HTMLVideoElement"),u=Object.keys(Ce).concat([Re,He,We,qe,Ue,Ne]),s=[];s[5121]=1,s[5126]=4,s[36193]=2,s[5123]=2,s[5125]=4;var c=[];c[32854]=2,c[32855]=2,c[36194]=2,c[34041]=4,c[33776]=.5,c[33777]=.5,c[33778]=1,c[33779]=1,c[35986]=.5,c[35987]=1,c[34798]=1,c[35840]=.5,c[35841]=.25,c[35842]=.5,c[35843]=.25,c[36196]=.5;var Qe=[];Qe[32854]=2,Qe[32855]=2,Qe[36194]=2,Qe[33189]=2,Qe[36168]=1,Qe[34041]=4,Qe[35907]=4,Qe[34836]=16,Qe[34842]=8,Qe[34843]=6;var Ge=[];Ge[6408]=4,Ge[6407]=3;var Ye=[];Ye[5121]=1,Ye[5126]=4,Ye[36193]=2;var Ke=["x","y","z","w"],I="blend.func blend.equation stencil.func stencil.opFront stencil.opBack sample.coverage viewport scissor.box polygonOffset.offset".split(" "),Xe={0:0,1:1,zero:0,one:1,"src color":768,"one minus src color":769,"src alpha":770,"one minus src alpha":771,"dst color":774,"one minus dst color":775,"dst alpha":772,"one minus dst alpha":773,"constant color":32769,"one minus constant color":32770,"constant alpha":32771,"one minus constant alpha":32772,"src alpha saturate":776},Je={never:512,less:513,"<":513,equal:514,"=":514,"==":514,"===":514,lequal:515,"<=":515,greater:516,">":516,notequal:517,"!=":517,"!==":517,gequal:518,">=":518,always:519},Ze={0:0,zero:0,keep:7680,replace:7681,increment:7682,decrement:7683,"increment wrap":34055,"decrement wrap":34056,invert:5386},$e={cw:2304,ccw:2305},R=new ee(!1,!1,!1,function(){});return function(e){function n(){if(0===Q.length)C&&C.update(),X=null;else{X=_e.next(n),c();for(var e=Q.length-1;0<=e;--e){var t=Q[e];t&&t(V,null,0)}d.flush(),C&&C.update()}}function r(){!X&&0<Q.length&&(X=_e.next(n))}function i(){X&&(_e.cancel(n),X=null)}function t(e){e.preventDefault(),i(),G.forEach(function(e){e()})}function a(e){d.getError(),m.restore(),I.restore(),B.restore(),R.restore(),H.restore(),W.restore(),M.restore(),C&&C.restore(),q.procs.refresh(),r(),Y.forEach(function(e){e()})}function o(e){function t(r,i){var a={},o={};return Object.keys(r).forEach(function(e){var t=r[e];if(Ae.isDynamic(t))o[e]=Ae.unbox(t,e);else{if(i&&Array.isArray(t))for(var n=0;n<t.length;++n)if(Ae.isDynamic(t[n]))return void(o[e]=Ae.unbox(t,e));a[e]=t}}),{dynamic:o,static:a}}var r,n=t(e.context||{},!0),i=t(e.uniforms||{},!0),a=t(e.attributes||{},!1);function o(t){var n;t in r&&(n=r[t],delete r[t],Object.keys(n).forEach(function(e){r[t+"."+e]=n[e]}))}e=t((delete(r=we({},f=e)).uniforms,delete r.attributes,delete r.context,delete r.vao,"stencil"in r&&r.stencil.op&&(r.stencil.opBack=r.stencil.opFront=r.stencil.op,delete r.stencil.op),o("blend"),o("depth"),o("cull"),o("stencil"),o("polygonOffset"),o("scissor"),o("sample"),"vao"in f&&(r.vao=f.vao),r),!1);var f={gpuTime:0,cpuTime:0,count:0},u=q.compile(e,a,i,n,f),s=u.draw,c=u.batch,l=u.scope,p=[];return we(function(e,t){var n;if("function"==typeof e)return l.call(this,null,e,0);if("function"!=typeof t)return"number"!=typeof e?Array.isArray(e)?e.length?c.call(this,e,e.length):void 0:s.call(this,e):0<e?c.call(this,function(e){for(;p.length<e;)p.push(null);return p}(0|e),0|e):void 0;if("number"==typeof e)for(n=0;n<e;++n)l.call(this,null,t,n);else{if(!Array.isArray(e))return l.call(this,e,t,0);for(n=0;n<e.length;++n)l.call(this,e[n],t,n)}},{stats:f,destroy:function(){u.destroy()}})}function f(e,t){var n=0;q.procs.poll();var r=t.color;r&&(d.clearColor(+r[0]||0,+r[1]||0,+r[2]||0,+r[3]||0),n|=16384),"depth"in t&&(d.clearDepth(+t.depth),n|=256),"stencil"in t&&(d.clearStencil(0|t.stencil),n|=1024),d.clear(n)}function u(t){return Q.push(t),r(),{cancel:function(){var e=xe(Q,t);Q[e]=function e(){var t=xe(Q,e);Q[t]=Q[Q.length-1],--Q.length,Q.length<=0&&i()}}}}function s(){var e=U.viewport,t=U.scissor_box;e[0]=e[1]=t[0]=t[1]=0,V.viewportWidth=V.framebufferWidth=V.drawingBufferWidth=e[2]=t[2]=d.drawingBufferWidth,V.viewportHeight=V.framebufferHeight=V.drawingBufferHeight=e[3]=t[3]=d.drawingBufferHeight}function c(){V.tick+=1,V.time=p(),s(),q.procs.poll()}function l(){R.refresh(),s(),q.procs.refresh(),C&&C.update()}function p(){return(ke()-j)/1e3}if(!(e=re(e)))return null;var d=e.gl,h=d.getContextAttributes();d.isContextLost();var m=function(n,e){function t(e){var t;e=e.toLowerCase();try{t=r[e]=n.getExtension(e)}catch(e){}return!!t}for(var r={},i=0;i<e.extensions.length;++i){var a=e.extensions[i];if(!t(a))return e.onDestroy(),e.onDone('"'+a+'" extension is not supported by the current WebGL context, try upgrading your system or a different browser'),null}return e.optionalExtensions.forEach(t),{extensions:r,restore:function(){Object.keys(r).forEach(function(e){if(r[e]&&!t(e))throw Error("(regl): error restoring extension "+e)})}}}(d,e);if(!m)return null;var b,v,g,y,x,w,A,_,k,E,D,O=(E={"":0},D=[""],{id:function(e){var t=E[e];return t||(t=E[e]=D.length,D.push(e),t)},str:function(e){return D[e]}}),S={vaoCount:0,bufferCount:0,elementsCount:0,framebufferCount:0,shaderCount:0,textureCount:0,cubeCount:0,renderbufferCount:0,maxTextureUnits:0},T=m.extensions,C=function(a){function i(){this.endQueryIndex=this.startQueryIndex=-1,this.sum=0,this.stats=null}function n(e,t,n){var r=u.pop()||new i;r.startQueryIndex=e,r.endQueryIndex=t,r.sum=0,r.stats=n,s.push(r)}if(!a.ext_disjoint_timer_query)return null;var o=[],f=[],u=[],s=[],c=[],l=[];return{beginQuery:function(e){var t=o.pop()||a.ext_disjoint_timer_query.createQueryEXT();a.ext_disjoint_timer_query.beginQueryEXT(35007,t),f.push(t),n(f.length-1,f.length,e)},endQuery:function(){a.ext_disjoint_timer_query.endQueryEXT(35007)},pushScopeStats:n,update:function(){var e=f.length;if(0!==e){l.length=Math.max(l.length,e+1),c.length=Math.max(c.length,e+1),c[0]=0;for(var t=l[0]=0,n=e=0;n<f.length;++n){var r=f[n];a.ext_disjoint_timer_query.getQueryObjectEXT(r,34919)?(t+=a.ext_disjoint_timer_query.getQueryObjectEXT(r,34918),o.push(r)):f[e++]=r,c[n+1]=t,l[n+1]=e}for(f.length=e,n=e=0;n<s.length;++n){var i=(t=s[n]).startQueryIndex,r=t.endQueryIndex;t.sum+=c[r]-c[i],i=l[i],(r=l[r])===i?(t.stats.gpuTime+=t.sum/1e6,u.push(t)):(t.startQueryIndex=i,t.endQueryIndex=r,s[e++]=t)}s.length=e}},getNumPendingQueries:function(){return f.length},clear:function(){o.push.apply(o,f);for(var e=0;e<o.length;e++)a.ext_disjoint_timer_query.deleteQueryEXT(o[e]);f.length=0,o.length=0},restore:function(){f.length=0,o.length=0}}}(T),j=ke(),z=d.drawingBufferWidth,F=d.drawingBufferHeight,V={tick:0,time:0,viewportWidth:z,viewportHeight:F,framebufferWidth:z,framebufferHeight:F,drawingBufferWidth:z,drawingBufferHeight:F,pixelRatio:e.pixelRatio},z={elements:null,primitive:4,count:-1,offset:0,instances:-1},L=function(e,t){var n=1;t.ext_texture_filter_anisotropic&&(n=e.getParameter(34047));var r=1,i=1;t.webgl_draw_buffers&&(r=e.getParameter(34852),i=e.getParameter(36063));var a,o,f=!!t.oes_texture_float;return f&&(f=e.createTexture(),e.bindTexture(3553,f),e.texImage2D(3553,0,6408,1,1,0,6408,5126,null),a=e.createFramebuffer(),e.bindFramebuffer(36160,a),e.framebufferTexture2D(36160,36064,3553,f,0),e.bindTexture(3553,null),36053!==e.checkFramebufferStatus(36160)?f=!1:(e.viewport(0,0,1,1),e.clearColor(1,0,0,1),e.clear(16384),o=Ee.allocType(5126,4),e.readPixels(0,0,1,1,6408,5126,o),f=!e.getError()&&(e.deleteFramebuffer(a),e.deleteTexture(f),1===o[0]),Ee.freeType(o))),o=!0,"undefined"!=typeof navigator&&(/MSIE/.test(navigator.userAgent)||/Trident\//.test(navigator.appVersion)||/Edge/.test(navigator.userAgent))||(o=e.createTexture(),a=Ee.allocType(5121,36),e.activeTexture(33984),e.bindTexture(34067,o),e.texImage2D(34069,0,6408,3,3,0,6408,5121,a),Ee.freeType(a),e.bindTexture(34067,null),e.deleteTexture(o),o=!e.getError()),{colorBits:[e.getParameter(3410),e.getParameter(3411),e.getParameter(3412),e.getParameter(3413)],depthBits:e.getParameter(3414),stencilBits:e.getParameter(3415),subpixelBits:e.getParameter(3408),extensions:Object.keys(t).filter(function(e){return!!t[e]}),maxAnisotropic:n,maxDrawbuffers:r,maxColorAttachments:i,pointSizeDims:e.getParameter(33901),lineWidthDims:e.getParameter(33902),maxViewportDims:e.getParameter(3386),maxCombinedTextureUnits:e.getParameter(35661),maxCubeMapSize:e.getParameter(34076),maxRenderbufferSize:e.getParameter(34024),maxTextureUnits:e.getParameter(34930),maxTextureSize:e.getParameter(3379),maxAttributes:e.getParameter(34921),maxVertexUniforms:e.getParameter(36347),maxVertexTextureUnits:e.getParameter(35660),maxVaryingVectors:e.getParameter(36348),maxFragmentUniforms:e.getParameter(36349),glsl:e.getParameter(35724),renderer:e.getParameter(7937),vendor:e.getParameter(7936),version:e.getParameter(7938),readFloat:f,npotTextureCube:o}}(d,T),B=function(c,r,f,t){function i(e){this.id=n++,this.buffer=c.createBuffer(),this.type=e,this.usage=35044,this.byteLength=0,this.dimension=1,this.dtype=5121,this.persistentData=null,f.profile&&(this.stats={size:0})}function p(e,t,n){e.byteLength=t.byteLength,c.bufferData(e.type,t,n)}function l(e,t,n,r,i,a){var o,f,u,s,c;if(e.usage=n,Array.isArray(t)){if(e.dtype=r||5126,0<t.length)if(Array.isArray(t[0])){i=Ve(t);for(var l=r=1;l<i.length;++l)r*=i[l];e.dimension=r,p(e,t=Fe(t,i,e.dtype),n),a?e.persistentData=t:Ee.freeType(t)}else"number"==typeof t[0]?(e.dimension=i,oe(i=Ee.allocType(e.dtype,t.length),t),p(e,i,n),a?e.persistentData=i:Ee.freeType(i)):Oe(t[0])&&(e.dimension=t[0].length,e.dtype=r||ae(t[0])||5126,p(e,t=Fe(t,[t.length,t[0].length],e.dtype),n),a?e.persistentData=t:Ee.freeType(t))}else Oe(t)?(e.dtype=r||ae(t),e.dimension=i,p(e,t,n),a&&(e.persistentData=new Uint8Array(new Uint8Array(t.buffer)))):ie(t)?(i=t.shape,o=t.stride,l=t.offset,c=s=u=f=0,1===i.length?(f=i[0],u=1,s=o[0],c=0):2===i.length&&(f=i[0],u=i[1],s=o[0],c=o[1]),e.dtype=r||ae(t.data)||5126,e.dimension=u,fe(i=Ee.allocType(e.dtype,f*u),t.data,f,u,s,c,l),p(e,i,n),a?e.persistentData=i:Ee.freeType(i)):t instanceof ArrayBuffer&&(e.dtype=5121,e.dimension=i,p(e,t,n),a&&(e.persistentData=new Uint8Array(new Uint8Array(t))))}function a(e){r.bufferCount--,t(e),c.deleteBuffer(e.buffer),e.buffer=null,delete d[e.id]}var n=0,d={};i.prototype.bind=function(){c.bindBuffer(this.type,this.buffer)},i.prototype.destroy=function(){a(this)};var o=[];return f.profile&&(r.getTotalBufferSize=function(){var t=0;return Object.keys(d).forEach(function(e){t+=d[e].stats.size}),t}),{create:function(e,t,n,o){function u(e){var t=35044,n=null,r=0,i=0,a=1;return Array.isArray(e)||Oe(e)||ie(e)||e instanceof ArrayBuffer?n=e:"number"==typeof e?r=0|e:e&&("data"in e&&(n=e.data),"usage"in e&&(t=ze[e.usage]),"type"in e&&(i=je[e.type]),"dimension"in e&&(a=0|e.dimension),"length"in e&&(r=0|e.length)),s.bind(),n?l(s,n,t,i,a,o):(r&&c.bufferData(s.type,r,t),s.dtype=i||5121,s.usage=t,s.dimension=a,s.byteLength=r),f.profile&&(s.stats.size=s.byteLength*Le[s.dtype]),u}r.bufferCount++;var s=new i(t);return d[s.id]=s,n||u(e),u._reglType="buffer",u._buffer=s,u.subdata=function(e,t){var n,r,i,a,o,f=0|(t||0);return s.bind(),Oe(e)||e instanceof ArrayBuffer?c.bufferSubData(s.type,f,e):Array.isArray(e)?0<e.length&&("number"==typeof e[0]?(oe(r=Ee.allocType(s.dtype,e.length),e),c.bufferSubData(s.type,f,r),Ee.freeType(r)):(Array.isArray(e[0])||Oe(e[0]))&&(n=Ve(e),r=Fe(e,n,s.dtype),c.bufferSubData(s.type,f,r),Ee.freeType(r))):ie(e)&&(n=e.shape,i=e.stride,t=o=a=r=0,1===n.length?(r=n[0],a=1,o=i[0],t=0):2===n.length&&(r=n[0],a=n[1],o=i[0],t=i[1]),n=Array.isArray(e.data)?s.dtype:ae(e.data),fe(n=Ee.allocType(n,r*a),e.data,r,a,o,t,e.offset),c.bufferSubData(s.type,f,n),Ee.freeType(n)),u},f.profile&&(u.stats=s.stats),u.destroy=function(){a(s)},u},createStream:function(e,t){var n=o.pop();return(n=n||new i(e)).bind(),l(n,t,35040,0,1,!1),n},destroyStream:function(e){o.push(e)},clear:function(){De(d).forEach(a),o.forEach(a)},getBuffer:function(e){return e&&e._buffer instanceof i?e._buffer:null},restore:function(){De(d).forEach(function(e){e.buffer=c.createBuffer(),c.bindBuffer(e.type,e.buffer),c.bufferData(e.type,e.persistentData||e.byteLength,e.usage)})},_initBuffer:l}}(d,S,e,function(e){return M.destroyBuffer(e)}),P=function(u,s,c,n){function r(e){this.id=a++,(t[this.id]=this).buffer=e,this.primType=4,this.type=this.vertCount=0}function l(e,t,n,r,i,a,o){var f;if(e.buffer.bind(),t?((f=o)||Oe(t)&&(!ie(t)||Oe(t.data))||(f=s.oes_element_index_uint?5125:5123),c._initBuffer(e.buffer,t,n,f,3)):(u.bufferData(34963,a,n),e.buffer.dtype=f||5121,e.buffer.usage=n,e.buffer.dimension=3,e.buffer.byteLength=a),!(f=o)){switch(e.buffer.dtype){case 5121:case 5120:f=5121;break;case 5123:case 5122:f=5123;break;case 5125:case 5124:f=5125}e.buffer.dtype=f}e.type=f,(t=i)<0&&(t=e.buffer.byteLength,5123===f?t>>=1:5125===f&&(t>>=2)),e.vertCount=t,(t=r)<0&&(t=4,1===(r=e.buffer.dimension)&&(t=0),2===r&&(t=1),3===r&&(t=4)),e.primType=t}function i(e){n.elementsCount--,delete t[e.id],e.buffer.destroy(),e.buffer=null}var t={},a=0,p={uint8:5121,uint16:5123};s.oes_element_index_uint&&(p.uint32=5125),r.prototype.bind=function(){this.buffer.bind()};var o=[];return{create:function(e,t){function f(e){var t,n,r,i,a,o;return e?"number"==typeof e?(u(e),s.primType=4,s.vertCount=0|e,s.type=5121):(t=null,n=35044,i=r=-1,o=a=0,Array.isArray(e)||Oe(e)||ie(e)?t=e:("data"in e&&(t=e.data),"usage"in e&&(n=ze[e.usage]),"primitive"in e&&(r=Be[e.primitive]),"count"in e&&(i=0|e.count),"type"in e&&(o=p[e.type]),"length"in e?a=0|e.length:(a=i,5123===o||5122===o?a*=2:5125!==o&&5124!==o||(a*=4))),l(s,t,n,r,i,a,o)):(u(),s.primType=4,s.vertCount=0,s.type=5121),f}var u=c.create(null,34963,!0),s=new r(u._buffer);return n.elementsCount++,f(e),f._reglType="elements",f._elements=s,f.subdata=function(e,t){return u.subdata(e,t),f},f.destroy=function(){i(s)},f},createStream:function(e){var t=o.pop();return l(t=t||new r(c.create(null,34963,!0,!1)._buffer),e,35040,-1,-1,0,0),t},destroyStream:function(e){o.push(e)},getElements:function(e){return"function"==typeof e&&e._elements instanceof r?e._elements:null},clear:function(){De(t).forEach(i)}}}(d,T,B,S),M=be(d,T,L,S,B,P,z),I=(b=d,v=O,g=S,x={},w={},A={},_=[],k=0,(y=e).profile&&(g.getMaxUniformsCount=function(){var t=0;return _.forEach(function(e){e.stats.uniformsCount>t&&(t=e.stats.uniformsCount)}),t},g.getMaxAttributesCount=function(){var t=0;return _.forEach(function(e){e.stats.attributesCount>t&&(t=e.stats.attributesCount)}),t}),{clear:function(){var e=b.deleteShader.bind(b);De(x).forEach(e),x={},De(w).forEach(e),w={},_.forEach(function(e){b.deleteProgram(e.program)}),_.length=0,A={},g.shaderCount=0},program:function(e,t,n,r){var i=A[t],a=(i=i||(A[t]={}))[e];if(a&&(a.refCount++,!r))return a;var o=new ee(t,e);return g.shaderCount++,te(o,0,r),a||(i[e]=o),_.push(o),we(o,{destroy:function(){var e;o.refCount--,o.refCount<=0&&(b.deleteProgram(o.program),e=_.indexOf(o),_.splice(e,1),g.shaderCount--),i[o.vertId].refCount<=0&&(b.deleteShader(w[o.vertId]),delete w[o.vertId],delete A[o.fragId][o.vertId]),Object.keys(A[o.fragId]).length||(b.deleteShader(x[o.fragId]),delete x[o.fragId],delete A[o.fragId])}})},restore:function(){x={},w={};for(var e=0;e<_.length;++e)te(_[e],0,_[e].attributes.map(function(e){return[e.location,e.name]}))},shader:$,frag:-1,vert:-1}),R=function(h,r,e,m,b,o,l){function n(){this.format=this.internalformat=6408,this.type=5121,this.flipY=this.premultiplyAlpha=this.compressed=!1,this.unpackAlignment=1,this.colorSpace=37444,this.channels=this.height=this.width=0}function p(e,t){e.internalformat=t.internalformat,e.format=t.format,e.type=t.type,e.compressed=t.compressed,e.premultiplyAlpha=t.premultiplyAlpha,e.flipY=t.flipY,e.unpackAlignment=t.unpackAlignment,e.colorSpace=t.colorSpace,e.width=t.width,e.height=t.height,e.channels=t.channels}function v(e,t){var n,r,i,a;"object"==typeof t&&t&&("premultiplyAlpha"in t&&(e.premultiplyAlpha=t.premultiplyAlpha),"flipY"in t&&(e.flipY=t.flipY),"alignment"in t&&(e.unpackAlignment=t.alignment),"colorSpace"in t&&(e.colorSpace=F[t.colorSpace]),"type"in t&&(e.type=V[t.type]),n=e.width,r=e.height,i=e.channels,a=!1,"shape"in t?(n=t.shape[0],r=t.shape[1],3===t.shape.length&&(i=t.shape[2],a=!0)):("radius"in t&&(n=r=t.radius),"width"in t&&(n=t.width),"height"in t&&(r=t.height),"channels"in t&&(i=t.channels,a=!0)),e.width=0|n,e.height=0|r,e.channels=0|i,n=!1,"format"in t&&(n=t.format,r=e.internalformat=L[n],e.format=U[r],n in V&&!("type"in t)&&(e.type=V[n]),n in B&&(e.compressed=!0),n=!0),!a&&n?e.channels=Ie[e.format]:a&&!n&&e.channels!==Me[e.format]&&(e.format=e.internalformat=Me[e.channels]))}function g(e){h.pixelStorei(37440,e.flipY),h.pixelStorei(37441,e.premultiplyAlpha),h.pixelStorei(37443,e.colorSpace),h.pixelStorei(3317,e.unpackAlignment)}function t(){n.call(this),this.yOffset=this.xOffset=0,this.data=null,this.needsFree=!1,this.element=null,this.needsCopy=!1}function d(e,t){var n=null;if(de(t)?n=t:t&&(v(e,t),"x"in t&&(e.xOffset=0|t.x),"y"in t&&(e.yOffset=0|t.y),de(t.data)&&(n=t.data)),t.copy){var r=b.viewportWidth,i=b.viewportHeight;e.width=e.width||r-e.xOffset,e.height=e.height||i-e.yOffset,e.needsCopy=!0}else if(n){if(Oe(n))e.channels=e.channels||4,e.data=n,"type"in t||5121!==e.type||(e.type=0|Ce[Object.prototype.toString.call(n)]);else if(ce(n)){switch(e.channels=e.channels||4,i=(r=n).length,e.type){case 5121:case 5123:case 5125:case 5126:(i=Ee.allocType(e.type,i)).set(r),e.data=i;break;case 36193:e.data=ue(r)}e.alignment=1,e.needsFree=!0}else if(ie(n)){r=n.data,Array.isArray(r)||5121!==e.type||(e.type=0|Ce[Object.prototype.toString.call(r)]);var a,i=n.shape,o=n.stride,f=3===i.length?(a=i[2],o[2]):a=1,u=i[0],s=i[1];i=o[0],o=o[1],e.alignment=1,e.width=u,e.height=s,e.channels=a,e.format=e.internalformat=Me[a],e.needsFree=!0,u=f,n=n.offset,a=e.width,f=e.height,s=e.channels;for(var c=Ee.allocType(36193===e.type?5126:e.type,a*f*s),l=0,p=0;p<f;++p)for(var d=0;d<a;++d)for(var h=0;h<s;++h)c[l++]=r[i*d+o*p+u*h+n];he(e,c)}else if(pe(n)===Re||pe(n)===He||pe(n)===We)pe(n)===Re||pe(n)===He?e.element=n:e.element=n.canvas,e.width=e.element.width,e.height=e.element.height,e.channels=4;else if(pe(n)===qe)e.element=n,e.width=n.width,e.height=n.height,e.channels=4;else if(pe(n)===Ue)e.element=n,e.width=n.naturalWidth,e.height=n.naturalHeight,e.channels=4;else if(pe(n)===Ne)e.element=n,e.width=n.videoWidth,e.height=n.videoHeight,e.channels=4;else if(le(n)){for(r=e.width||n[0].length,i=e.height||n.length,o=e.channels,o=se(n[0][0])?o||n[0][0].length:o||1,u=Se(n),a=1,f=0;f<u.length;++f)a*=u[f];a=Ee.allocType(36193===e.type?5126:e.type,a),Te(n,u,"",a),he(e,a),e.alignment=1,e.width=r,e.height=i,e.channels=o,e.format=e.internalformat=Me[o],e.needsFree=!0}}else e.width=e.width||1,e.height=e.height||1,e.channels=e.channels||4}function y(e,t,n,r,i){var a=e.element,o=e.data,f=e.internalformat,u=e.format,s=e.type,c=e.width,l=e.height;g(e),a?h.texSubImage2D(t,i,n,r,u,s,a):e.compressed?h.compressedTexSubImage2D(t,i,n,r,f,c,l,o):e.needsCopy?(m(),h.copyTexSubImage2D(t,i,n,r,e.xOffset,e.yOffset,c,l)):h.texSubImage2D(t,i,n,r,c,l,u,s,o)}function x(){return N.pop()||new t}function w(e){e.needsFree&&Ee.freeType(e.data),t.call(e),N.push(e)}function i(){n.call(this),this.genMipmaps=!1,this.mipmapHint=4352,this.mipmask=0,this.images=Array(16)}function A(e,t,n){var r=e.images[0]=x();e.mipmask=1,r.width=e.width=t,r.height=e.height=n,r.channels=e.channels=4}function _(e,t){var n=null;if(de(t))p(n=e.images[0]=x(),e),d(n,t),e.mipmask=1;else if(v(e,t),Array.isArray(t.mipmap))for(var r=t.mipmap,i=0;i<r.length;++i)p(n=e.images[i]=x(),e),n.width>>=i,n.height>>=i,d(n,r[i]),e.mipmask|=1<<i;else p(n=e.images[0]=x(),e),d(n,t),e.mipmask=1;p(e,e.images[0])}function k(e,t){for(var n=e.images,r=0;r<n.length&&n[r];++r){var i=n[r],a=t,o=r,f=i.element,u=i.data,s=i.internalformat,c=i.format,l=i.type,p=i.width,d=i.height;g(i),f?h.texImage2D(a,o,c,c,l,f):i.compressed?h.compressedTexImage2D(a,o,s,p,d,0,u):i.needsCopy?(m(),h.copyTexImage2D(a,o,c,i.xOffset,i.yOffset,p,d,0)):h.texImage2D(a,o,c,p,d,0,c,l,u||null)}}function E(){var e=Q.pop()||new i;n.call(e);for(var t=e.mipmask=0;t<16;++t)e.images[t]=null;return e}function D(e){for(var t=e.images,n=0;n<t.length;++n)t[n]&&w(t[n]),t[n]=null;Q.push(e)}function O(){this.magFilter=this.minFilter=9728,this.wrapT=this.wrapS=33071,this.anisotropic=1,this.genMipmaps=!1,this.mipmapHint=4352}function S(e,t){"min"in t&&(e.minFilter=c[t.min],0<=Pe.indexOf(e.minFilter)&&!("faces"in t)&&(e.genMipmaps=!0)),"mag"in t&&(e.magFilter=s[t.mag]);var n,r=e.wrapS,i=e.wrapT;if("wrap"in t?"string"==typeof(n=t.wrap)?r=i=u[n]:Array.isArray(n)&&(r=u[n[0]],i=u[n[1]]):("wrapS"in t&&(r=u[t.wrapS]),"wrapT"in t&&(i=u[t.wrapT])),e.wrapS=r,e.wrapT=i,"anisotropic"in t&&(e.anisotropic=t.anisotropic),"mipmap"in t){switch(r=!1,typeof t.mipmap){case"string":e.mipmapHint=f[t.mipmap],r=e.genMipmaps=!0;break;case"boolean":r=e.genMipmaps=t.mipmap;break;case"object":r=!(e.genMipmaps=!1)}!r||"min"in t||(e.minFilter=9984)}}function T(e,t){h.texParameteri(t,10241,e.minFilter),h.texParameteri(t,10240,e.magFilter),h.texParameteri(t,10242,e.wrapS),h.texParameteri(t,10243,e.wrapT),r.ext_texture_filter_anisotropic&&h.texParameteri(t,34046,e.anisotropic),e.genMipmaps&&(h.hint(33170,e.mipmapHint),h.generateMipmap(t))}function C(e){n.call(this),this.mipmask=0,this.internalformat=6408,this.id=G++,this.refCount=1,this.target=e,this.texture=h.createTexture(),this.unit=-1,this.bindCount=0,this.texInfo=new O,l.profile&&(this.stats={size:0})}function j(e){h.activeTexture(33984),h.bindTexture(e.target,e.texture)}function z(){var e=X[0];e?h.bindTexture(e.target,e.texture):h.bindTexture(3553,null)}function a(e){var t=e.texture,n=e.unit,r=e.target;0<=n&&(h.activeTexture(33984+n),h.bindTexture(r,null),X[n]=null),h.deleteTexture(t),e.texture=null,e.params=null,e.pixels=null,e.refCount=0,delete Y[e.id],o.textureCount--}var f={"don't care":4352,"dont care":4352,nice:4354,fast:4353},u={repeat:10497,clamp:33071,mirror:33648},s={nearest:9728,linear:9729},c=we({mipmap:9987,"nearest mipmap nearest":9984,"linear mipmap nearest":9985,"nearest mipmap linear":9986,"linear mipmap linear":9987},s),F={none:0,browser:37444},V={uint8:5121,rgba4:32819,rgb565:33635,"rgb5 a1":32820},L={alpha:6406,luminance:6409,"luminance alpha":6410,rgb:6407,rgba:6408,rgba4:32854,"rgb5 a1":32855,rgb565:36194},B={};r.ext_srgb&&(L.srgb=35904,L.srgba=35906),r.oes_texture_float&&(V.float32=V.float=5126),r.oes_texture_half_float&&(V.float16=V["half float"]=36193),r.webgl_depth_texture&&(we(L,{depth:6402,"depth stencil":34041}),we(V,{uint16:5123,uint32:5125,"depth stencil":34042})),r.webgl_compressed_texture_s3tc&&we(B,{"rgb s3tc dxt1":33776,"rgba s3tc dxt1":33777,"rgba s3tc dxt3":33778,"rgba s3tc dxt5":33779}),r.webgl_compressed_texture_atc&&we(B,{"rgb atc":35986,"rgba atc explicit alpha":35987,"rgba atc interpolated alpha":34798}),r.webgl_compressed_texture_pvrtc&&we(B,{"rgb pvrtc 4bppv1":35840,"rgb pvrtc 2bppv1":35841,"rgba pvrtc 4bppv1":35842,"rgba pvrtc 2bppv1":35843}),r.webgl_compressed_texture_etc1&&(B["rgb etc1"]=36196);var P=Array.prototype.slice.call(h.getParameter(34467));Object.keys(B).forEach(function(e){var t=B[e];0<=P.indexOf(t)&&(L[e]=t)});var M=Object.keys(L);e.textureFormats=M;var I=[];Object.keys(L).forEach(function(e){I[L[e]]=e});var R=[];Object.keys(V).forEach(function(e){R[V[e]]=e});var H=[];Object.keys(s).forEach(function(e){H[s[e]]=e});var W=[];Object.keys(c).forEach(function(e){W[c[e]]=e});var q=[];Object.keys(u).forEach(function(e){q[u[e]]=e});var U=M.reduce(function(e,t){var n=L[t];return 6409===n||6406===n||6409===n||6410===n||6402===n||34041===n||r.ext_srgb&&(35904===n||35906===n)?e[n]=n:32855===n||0<=t.indexOf("rgba")?e[n]=6408:e[n]=6407,e},{}),N=[],Q=[],G=0,Y={},K=e.maxTextureUnits,X=Array(K).map(function(){return null});return we(C.prototype,{bind:function(){this.bindCount+=1;var e=this.unit;if(e<0){for(var t=0;t<K;++t){var n=X[t];if(n){if(0<n.bindCount)continue;n.unit=-1}X[t]=this,e=t;break}l.profile&&o.maxTextureUnits<e+1&&(o.maxTextureUnits=e+1),this.unit=e,h.activeTexture(33984+e),h.bindTexture(this.target,this.texture)}return e},unbind:function(){--this.bindCount},decRef:function(){--this.refCount<=0&&a(this)}}),l.profile&&(o.getTotalTextureSize=function(){var t=0;return Object.keys(Y).forEach(function(e){t+=Y[e].stats.size}),t}),{create2D:function(e,t){function f(e,t){var n=u.texInfo;O.call(n);var r=E();return"number"==typeof e?A(r,0|e,"number"==typeof t?0|t:0|e):e?(S(n,e),_(r,e)):A(r,1,1),n.genMipmaps&&(r.mipmask=(r.width<<1)-1),u.mipmask=r.mipmask,p(u,r),u.internalformat=r.internalformat,f.width=r.width,f.height=r.height,j(u),k(r,3553),T(n,3553),z(),D(r),l.profile&&(u.stats.size=me(u.internalformat,u.type,r.width,r.height,n.genMipmaps,!1)),f.format=I[u.internalformat],f.type=R[u.type],f.mag=H[n.magFilter],f.min=W[n.minFilter],f.wrapS=q[n.wrapS],f.wrapT=q[n.wrapT],f}var u=new C(3553);return Y[u.id]=u,o.textureCount++,f(e,t),f.subimage=function(e,t,n,r){t|=0,n|=0,r|=0;var i=x();return p(i,u),i.width=0,i.height=0,d(i,e),i.width=i.width||(u.width>>r)-t,i.height=i.height||(u.height>>r)-n,j(u),y(i,3553,t,n,r),z(),w(i),f},f.resize=function(e,t){var n=0|e,r=0|t||n;if(n===u.width&&r===u.height)return f;f.width=u.width=n,f.height=u.height=r,j(u);for(var i=0;u.mipmask>>i;++i){var a=n>>i,o=r>>i;if(!a||!o)break;h.texImage2D(3553,i,u.format,a,o,0,u.format,u.type,null)}return z(),l.profile&&(u.stats.size=me(u.internalformat,u.type,n,r,!1,!1)),f},f._reglType="texture2d",f._texture=u,l.profile&&(f.stats=u.stats),f.destroy=function(){u.decRef()},f},createCube:function(e,t,n,r,i,a){function u(e,t,n,r,i,a){var o,f=s.texInfo;for(O.call(f),o=0;o<6;++o)c[o]=E();if("number"!=typeof e&&e){if("object"==typeof e)if(t)_(c[0],e),_(c[1],t),_(c[2],n),_(c[3],r),_(c[4],i),_(c[5],a);else if(S(f,e),v(s,e),"faces"in e)for(e=e.faces,o=0;o<6;++o)p(c[o],s),_(c[o],e[o]);else for(o=0;o<6;++o)_(c[o],e)}else for(e=0|e||1,o=0;o<6;++o)A(c[o],e,e);for(p(s,c[0]),s.mipmask=f.genMipmaps?(c[0].width<<1)-1:c[0].mipmask,s.internalformat=c[0].internalformat,u.width=c[0].width,u.height=c[0].height,j(s),o=0;o<6;++o)k(c[o],34069+o);for(T(f,34067),z(),l.profile&&(s.stats.size=me(s.internalformat,s.type,u.width,u.height,f.genMipmaps,!0)),u.format=I[s.internalformat],u.type=R[s.type],u.mag=H[f.magFilter],u.min=W[f.minFilter],u.wrapS=q[f.wrapS],u.wrapT=q[f.wrapT],o=0;o<6;++o)D(c[o]);return u}var s=new C(34067);Y[s.id]=s,o.cubeCount++;var c=Array(6);return u(e,t,n,r,i,a),u.subimage=function(e,t,n,r,i){n|=0,r|=0,i|=0;var a=x();return p(a,s),a.width=0,a.height=0,d(a,t),a.width=a.width||(s.width>>i)-n,a.height=a.height||(s.height>>i)-r,j(s),y(a,34069+e,n,r,i),z(),w(a),u},u.resize=function(e){if((e|=0)!==s.width){u.width=s.width=e,u.height=s.height=e,j(s);for(var t=0;t<6;++t)for(var n=0;s.mipmask>>n;++n)h.texImage2D(34069+t,n,s.format,e>>n,e>>n,0,s.format,s.type,null);return z(),l.profile&&(s.stats.size=me(s.internalformat,s.type,u.width,u.height,!1,!0)),u}},u._reglType="textureCube",u._texture=s,l.profile&&(u.stats=s.stats),u.destroy=function(){s.decRef()},u},clear:function(){for(var e=0;e<K;++e)h.activeTexture(33984+e),h.bindTexture(3553,null),X[e]=null;De(Y).forEach(a),o.cubeCount=0,o.textureCount=0},getTexture:function(e){return null},restore:function(){for(var e=0;e<K;++e){var t=X[e];t&&(t.bindCount=0,t.unit=-1,X[e]=null)}De(Y).forEach(function(e){e.texture=h.createTexture(),h.bindTexture(e.target,e.texture);for(var t=0;t<32;++t)if(0!=(e.mipmask&1<<t))if(3553===e.target)h.texImage2D(3553,t,e.internalformat,e.width>>t,e.height>>t,0,e.internalformat,e.type,null);else for(var n=0;n<6;++n)h.texImage2D(34069+n,t,e.internalformat,e.width>>t,e.height>>t,0,e.internalformat,e.type,null);T(e.texInfo,e.target)})},refresh:function(){for(var e=0;e<K;++e){var t=X[e];t&&(t.bindCount=0,t.unit=-1,X[e]=null),h.activeTexture(33984+e),h.bindTexture(3553,null),h.bindTexture(34067,null)}}}}(d,T,L,function(){q.procs.poll()},V,S,e),H=function(f,e,n,u){function r(e){this.id=i++,this.refCount=1,this.renderbuffer=e,this.format=32854,this.height=this.width=0,u.profile&&(this.stats={size:0})}function t(e){var t=e.renderbuffer;f.bindRenderbuffer(36161,null),f.deleteRenderbuffer(t),e.renderbuffer=null,e.refCount=0,delete l[e.id],n.renderbufferCount--}var s={rgba4:32854,rgb565:36194,"rgb5 a1":32855,depth:33189,stencil:36168,"depth stencil":34041};e.ext_srgb&&(s.srgba=35907),e.ext_color_buffer_half_float&&(s.rgba16f=34842,s.rgb16f=34843),e.webgl_color_buffer_float&&(s.rgba32f=34836);var c=[];Object.keys(s).forEach(function(e){c[s[e]]=e});var i=0,l={};return r.prototype.decRef=function(){--this.refCount<=0&&t(this)},u.profile&&(n.getTotalRenderbufferSize=function(){var t=0;return Object.keys(l).forEach(function(e){t+=l[e].stats.size}),t}),{create:function(e,t){function a(e,t){var n=0,r=0,i=32854;if("object"==typeof e&&e?("shape"in e?(n=0|(r=e.shape)[0],r=0|r[1]):("radius"in e&&(n=r=0|e.radius),"width"in e&&(n=0|e.width),"height"in e&&(r=0|e.height)),"format"in e&&(i=s[e.format])):"number"==typeof e?(n=0|e,r="number"==typeof t?0|t:n):e||(n=r=1),n!==o.width||r!==o.height||i!==o.format)return a.width=o.width=n,a.height=o.height=r,o.format=i,f.bindRenderbuffer(36161,o.renderbuffer),f.renderbufferStorage(36161,i,n,r),u.profile&&(o.stats.size=Qe[o.format]*o.width*o.height),a.format=c[o.format],a}var o=new r(f.createRenderbuffer());return l[o.id]=o,n.renderbufferCount++,a(e,t),a.resize=function(e,t){e|=0,t=0|t||e;return e===o.width&&t===o.height||(a.width=o.width=e,a.height=o.height=t,f.bindRenderbuffer(36161,o.renderbuffer),f.renderbufferStorage(36161,o.format,e,t),u.profile&&(o.stats.size=Qe[o.format]*o.width*o.height)),a},a._reglType="renderbuffer",a._renderbuffer=o,u.profile&&(a.stats=o.stats),a.destroy=function(){o.decRef()},a},clear:function(){De(l).forEach(t)},restore:function(){De(l).forEach(function(e){e.renderbuffer=f.createRenderbuffer(),f.bindRenderbuffer(36161,e.renderbuffer),f.renderbufferStorage(36161,e.format,e.width,e.height)}),f.bindRenderbuffer(36161,null)}}}(d,T,S,e),W=function(r,e,i,s,a,n){function o(e,t,n){this.target=e,this.texture=t,this.renderbuffer=n;var r=e=0;t?(e=t.width,r=t.height):n&&(e=n.width,r=n.height),this.width=e,this.height=r}function t(e){e&&(e.texture&&e.texture._texture.decRef(),e.renderbuffer&&e.renderbuffer._renderbuffer.decRef())}function y(e){e&&(e.texture?e.texture._texture.refCount+=1:e.renderbuffer._renderbuffer.refCount+=1)}function f(e,t){t&&(t.texture?r.framebufferTexture2D(36160,e,t.target,t.texture._texture.texture,0):r.framebufferRenderbuffer(36160,e,36161,t.renderbuffer._renderbuffer.renderbuffer))}function x(e){var t=3553,n=null,r=null,i=e;return"object"==typeof e&&(i=e.data,"target"in e&&(t=0|e.target)),"texture2d"===(e=i._reglType)||"textureCube"===e?n=i:"renderbuffer"===e&&(r=i,t=36161),new o(t,n,r)}function w(e,t,n,r,i){return n?((e=s.create2D({width:e,height:t,format:r,type:i}))._texture.refCount=0,new o(3553,e,null)):((e=a.create({width:e,height:t,format:r}))._renderbuffer.refCount=0,new o(36161,null,e))}function A(e){return e&&(e.texture||e.renderbuffer)}function u(e,t,n){e&&(e.texture?e.texture.resize(t,n):e.renderbuffer&&e.renderbuffer.resize(t,n),e.width=t,e.height=n)}function c(){this.id=m++,(b[this.id]=this).framebuffer=r.createFramebuffer(),this.height=this.width=0,this.colorAttachments=[],this.depthStencilAttachment=this.stencilAttachment=this.depthAttachment=null}function _(e){e.colorAttachments.forEach(t),t(e.depthAttachment),t(e.stencilAttachment),t(e.depthStencilAttachment)}function l(e){r.deleteFramebuffer(e.framebuffer),e.framebuffer=null,n.framebufferCount--,delete b[e.id]}function k(e){r.bindFramebuffer(36160,e.framebuffer);for(var t=e.colorAttachments,n=0;n<t.length;++n)f(36064+n,t[n]);for(n=t.length;n<i.maxColorAttachments;++n)r.framebufferTexture2D(36160,36064+n,3553,null,0);r.framebufferTexture2D(36160,33306,3553,null,0),r.framebufferTexture2D(36160,36096,3553,null,0),r.framebufferTexture2D(36160,36128,3553,null,0),f(36096,e.depthAttachment),f(36128,e.stencilAttachment),f(33306,e.depthStencilAttachment),r.checkFramebufferStatus(36160),r.isContextLost(),r.bindFramebuffer(36160,d.next?d.next.framebuffer:null),d.cur=d.next,r.getError()}function p(e,t){function v(e,t){var n=0,r=0,i=!0,a=!0,o=null,f=!0,u="rgba",s="uint8",c=1,l=null,p=null,d=null,h=!1;"number"==typeof e?(n=0|e,r=0|t||n):e?("shape"in e?(n=(r=e.shape)[0],r=r[1]):("radius"in e&&(n=r=e.radius),"width"in e&&(n=e.width),"height"in e&&(r=e.height)),("color"in e||"colors"in e)&&(o=e.color||e.colors,Array.isArray(o)),o||("colorCount"in e&&(c=0|e.colorCount),"colorTexture"in e&&(f=!!e.colorTexture,u="rgba4"),"colorType"in e&&(s=e.colorType,!f)&&("half float"===s||"float16"===s?u="rgba16f":"float"!==s&&"float32"!==s||(u="rgba32f")),"colorFormat"in e&&(u=e.colorFormat,0<=E.indexOf(u)?f=!0:0<=D.indexOf(u)&&(f=!1))),("depthTexture"in e||"depthStencilTexture"in e)&&(h=!(!e.depthTexture&&!e.depthStencilTexture)),"depth"in e&&("boolean"==typeof e.depth?i=e.depth:(l=e.depth,a=!1)),"stencil"in e&&("boolean"==typeof e.stencil?a=e.stencil:(p=e.stencil,i=!1)),"depthStencil"in e&&("boolean"==typeof e.depthStencil?i=a=e.depthStencil:(d=e.depthStencil,a=i=!1))):n=r=1;var m=null,b=null,t=null,e=null;if(Array.isArray(o))m=o.map(x);else if(o)m=[x(o)];else for(m=Array(c),o=0;o<c;++o)m[o]=w(n,r,f,u,s);for(n=n||m[0].width,r=r||m[0].height,l?b=x(l):i&&!a&&(b=w(n,r,h,"depth","uint32")),p?t=x(p):a&&!i&&(t=w(n,r,!1,"stencil","uint8")),d?e=x(d):!l&&!p&&a&&i&&(e=w(n,r,h,"depth stencil","depth stencil")),i=null,o=0;o<m.length;++o)y(m[o]),m[o]&&m[o].texture&&(a=Ge[m[o].texture._texture.format]*Ye[m[o].texture._texture.type],null===i&&(i=a));return y(b),y(t),y(e),_(g),g.width=n,g.height=r,g.colorAttachments=m,g.depthAttachment=b,g.stencilAttachment=t,g.depthStencilAttachment=e,v.color=m.map(A),v.depth=A(b),v.stencil=A(t),v.depthStencil=A(e),v.width=g.width,v.height=g.height,k(g),v}var g=new c;return n.framebufferCount++,v(e,t),we(v,{resize:function(e,t){var n=Math.max(0|e,1),r=Math.max(0|t||n,1);if(n===g.width&&r===g.height)return v;for(var i=g.colorAttachments,a=0;a<i.length;++a)u(i[a],n,r);return u(g.depthAttachment,n,r),u(g.stencilAttachment,n,r),u(g.depthStencilAttachment,n,r),g.width=v.width=n,g.height=v.height=r,k(g),v},_reglType:"framebuffer",_framebuffer:g,destroy:function(){l(g),_(g)},use:function(e){d.setFBO({framebuffer:v},e)}})}var d={cur:null,next:null,dirty:!1,setFBO:null},E=["rgba"],D=["rgba4","rgb565","rgb5 a1"];e.ext_srgb&&D.push("srgba"),e.ext_color_buffer_half_float&&D.push("rgba16f","rgb16f"),e.webgl_color_buffer_float&&D.push("rgba32f");var h=["uint8"];e.oes_texture_half_float&&h.push("half float","float16"),e.oes_texture_float&&h.push("float","float32");var m=0,b={};return we(d,{getFramebuffer:function(e){return"function"==typeof e&&"framebuffer"===e._reglType&&(e=e._framebuffer)instanceof c?e:null},create:p,createCube:function(e){function f(e){var t={color:null},n=0,r=null,i="rgba",a="uint8",o=1;if("number"==typeof e?n=0|e:e?("shape"in e?n=e.shape[0]:("radius"in e&&(n=0|e.radius),"width"in e?n=0|e.width:"height"in e&&(n=0|e.height)),("color"in e||"colors"in e)&&(r=e.color||e.colors,Array.isArray(r)),r||("colorCount"in e&&(o=0|e.colorCount),"colorType"in e&&(a=e.colorType),"colorFormat"in e&&(i=e.colorFormat)),"depth"in e&&(t.depth=e.depth),"stencil"in e&&(t.stencil=e.stencil),"depthStencil"in e&&(t.depthStencil=e.depthStencil)):n=1,r)if(Array.isArray(r))for(e=[],i=0;i<r.length;++i)e[i]=r[i];else e=[r];else for(e=Array(o),r={radius:n,format:i,type:a},i=0;i<o;++i)e[i]=s.createCube(r);for(t.color=Array(e.length),i=0;i<e.length;++i)o=e[i],n=n||o.width,t.color[i]={target:34069,data:e[i]};for(i=0;i<6;++i){for(o=0;o<e.length;++o)t.color[o].target=34069+i;0<i&&(t.depth=u[0].depth,t.stencil=u[0].stencil,t.depthStencil=u[0].depthStencil),u[i]?u[i](t):u[i]=p(t)}return we(f,{width:n,height:n,color:e})}var u=Array(6);return f(e),we(f,{faces:u,resize:function(e){var t=0|e;if(t===f.width)return f;var n=f.color;for(e=0;e<n.length;++e)n[e].resize(t);for(e=0;e<6;++e)u[e].resize(t);return f.width=f.height=t,f},_reglType:"framebufferCube",destroy:function(){u.forEach(function(e){e.destroy()})}})},clear:function(){De(b).forEach(l)},restore:function(){d.cur=null,d.next=null,d.dirty=!0,De(b).forEach(function(e){e.framebuffer=r.createFramebuffer(),k(e)})}})}(d,T,L,R,H,S),q=ye(d,O,T,L,B,P,0,W,{},M,I,z,V,C,e),O=ve(d,W,q.procs.poll,V),U=q.next,N=d.canvas,Q=[],G=[],Y=[],K=[e.onDestroy],X=null;function J(e,t,n,r){this.name=e,this.id=t,this.location=n,this.info=r}function Z(e,t){for(var n=0;n<e.length;++n)if(e[n].id===t.id)return void(e[n].location=t.location);e.push(t)}function $(e,t,n){var r,i=(n=35632===e?x:w)[t];return i||(r=v.str(t),i=b.createShader(e),b.shaderSource(i,r),b.compileShader(i),n[t]=i),i}function ee(e,t){this.id=k++,this.fragId=e,this.vertId=t,this.program=null,this.uniforms=[],this.attributes=[],this.refCount=1,y.profile&&(this.stats={uniformsCount:0,attributesCount:0})}function te(e,t,n){var r=$(35632,e.fragId),i=$(35633,e.vertId);if(t=e.program=b.createProgram(),b.attachShader(t,r),b.attachShader(t,i),n)for(r=0;r<n.length;++r)i=n[r],b.bindAttribLocation(t,i[0],i[1]);b.linkProgram(t),i=b.getProgramParameter(t,35718),y.profile&&(e.stats.uniformsCount=i);var a=e.uniforms;for(r=0;r<i;++r)if(n=b.getActiveUniform(t,r))if(1<n.size)for(var o=0;o<n.size;++o){var f=n.name.replace("[0]","["+o+"]");Z(a,new J(f,v.id(f),b.getUniformLocation(t,f),n))}else Z(a,new J(n.name,v.id(n.name),b.getUniformLocation(t,n.name),n));for(i=b.getProgramParameter(t,35721),y.profile&&(e.stats.attributesCount=i),e=e.attributes,r=0;r<i;++r)(n=b.getActiveAttrib(t,r))&&Z(e,new J(n.name,v.id(n.name),b.getAttribLocation(t,n.name),n))}N&&(N.addEventListener("webglcontextlost",t,!1),N.addEventListener("webglcontextrestored",a,!1));var ne=W.setFBO=o({framebuffer:Ae.define.call(null,1,"framebuffer")});return l(),h=we(o,{clear:function(e){if("framebuffer"in e)if(e.framebuffer&&"framebufferCube"===e.framebuffer_reglType)for(var t=0;t<6;++t)ne(we({framebuffer:e.framebuffer.faces[t]},e),f);else ne(e,f);else f(0,e)},prop:Ae.define.bind(null,1),context:Ae.define.bind(null,2),this:Ae.define.bind(null,3),draw:o({}),buffer:function(e){return B.create(e,34962,!1,!1)},elements:function(e){return P.create(e,!1)},texture:R.create2D,cube:R.createCube,renderbuffer:H.create,framebuffer:W.create,framebufferCube:W.createCube,vao:M.createVAO,attributes:h,frame:u,on:function(e,t){var n;switch(e){case"frame":return u(t);case"lost":n=G;break;case"restore":n=Y;break;case"destroy":n=K}return n.push(t),{cancel:function(){for(var e=0;e<n.length;++e)if(n[e]===t){n[e]=n[n.length-1],n.pop();break}}}},limits:L,hasExtension:function(e){return 0<=L.extensions.indexOf(e.toLowerCase())},read:O,destroy:function(){Q.length=0,i(),N&&(N.removeEventListener("webglcontextlost",t),N.removeEventListener("webglcontextrestored",a)),I.clear(),W.clear(),H.clear(),M.clear(),R.clear(),P.clear(),B.clear(),C&&C.clear(),K.forEach(function(e){e()})},_gl:d,_refresh:l,poll:function(){c(),C&&C.update()},now:p,stats:S}),e.onDone(null,h),h}},"object"==typeof n&&void 0!==t?t.exports=i():"function"==typeof define&&define.amd?define(i):r.createREGL=i()},{}],11:[function(e,t,n){"use strict";var i=e("parse-unit");t.exports=u;var a=f("in",document.body);function o(e,t){t=i(getComputedStyle(e).getPropertyValue(t));return t[0]*u(t[1],e)}function f(e,t){var n=document.createElement("div");n.style.height="128"+e,t.appendChild(n);e=o(n,"height")/128;return t.removeChild(n),e}function u(e,t){if(!e)return null;switch(t=t||document.body,e=(e+""||"px").trim().toLowerCase(),t!==window&&t!==document||(t=document.body),e){case"%":return t.clientHeight/100;case"ch":case"ex":return f(e,t);case"em":return o(t,"font-size");case"rem":return o(document.body,"font-size");case"vw":return window.innerWidth/100;case"vh":return window.innerHeight/100;case"vmin":return Math.min(window.innerWidth,window.innerHeight)/100;case"vmax":return Math.max(window.innerWidth,window.innerHeight)/100;case"in":return a;case"cm":return a/2.54;case"mm":return a/25.4;case"pt":return a/72;case"pc":return a/6;case"px":return 1}var n=i(e);if(isNaN(n[0])||!n[1])return null;var r=u(n[1],t);return"number"==typeof r?n[0]*r:null}},{"parse-unit":8}],12:[function(e,t,n){var r=e("regl")({pixelRatio:Math.min(window.devicePixelRatio,1.5),attributes:{antialias:!1,stencil:!1,alpha:!1,depth:!0}}),i=e("regl-camera")(r,{distance:10,phi:.7,theta:1.5,center:[0,0,0],damping:0,noScroll:!0}),e=e("glslify"),a=r({frag:e(["precision mediump float;\n#define GLSLIFY 1\n\n#define PI 3.141592653589\n#define PI2 6.28318530718\n\nuniform vec3 u_LightColor;\nuniform vec3 u_DarkColor;\nuniform float u_Frequency;\nuniform float u_NoiseScale;\nuniform float u_RingScale;\nuniform float u_Contrast;\nuniform float u_time;\n\nvarying vec3 vPosition;\n\n//\n// Description : Array and textureless GLSL 2D/3D/4D simplex\n//               noise functions.\n//      Author : Ian McEwan, Ashima Arts.\n//  Maintainer : ijm\n//     Lastmod : 20110822 (ijm)\n//     License : Copyright (C) 2011 Ashima Arts. All rights reserved.\n//               Distributed under the MIT License. See LICENSE file.\n//               https://github.com/ashima/webgl-noise\n//\n\nvec3 mod289(vec3 x) {\n  return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\n\nvec4 mod289(vec4 x) {\n  return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\n\nvec4 permute(vec4 x) {\n     return mod289(((x*34.0)+1.0)*x);\n}\n\nvec4 taylorInvSqrt(vec4 r)\n{\n  return 1.79284291400159 - 0.85373472095314 * r;\n}\n\nfloat snoise(vec3 v)\n  {\n  const vec2  C = vec2(1.0/6.0, 1.0/3.0) ;\n  const vec4  D = vec4(0.0, 0.5, 1.0, 2.0);\n\n// First corner\n  vec3 i  = floor(v + dot(v, C.yyy) );\n  vec3 x0 =   v - i + dot(i, C.xxx) ;\n\n// Other corners\n  vec3 g = step(x0.yzx, x0.xyz);\n  vec3 l = 1.0 - g;\n  vec3 i1 = min( g.xyz, l.zxy );\n  vec3 i2 = max( g.xyz, l.zxy );\n\n  //   x0 = x0 - 0.0 + 0.0 * C.xxx;\n  //   x1 = x0 - i1  + 1.0 * C.xxx;\n  //   x2 = x0 - i2  + 2.0 * C.xxx;\n  //   x3 = x0 - 1.0 + 3.0 * C.xxx;\n  vec3 x1 = x0 - i1 + C.xxx;\n  vec3 x2 = x0 - i2 + C.yyy; // 2.0*C.x = 1/3 = C.y\n  vec3 x3 = x0 - D.yyy;      // -1.0+3.0*C.x = -0.5 = -D.y\n\n// Permutations\n  i = mod289(i);\n  vec4 p = permute( permute( permute(\n             i.z + vec4(0.0, i1.z, i2.z, 1.0 ))\n           + i.y + vec4(0.0, i1.y, i2.y, 1.0 ))\n           + i.x + vec4(0.0, i1.x, i2.x, 1.0 ));\n\n// Gradients: 7x7 points over a square, mapped onto an octahedron.\n// The ring size 17*17 = 289 is close to a multiple of 49 (49*6 = 294)\n  float n_ = 0.142857142857; // 1.0/7.0\n  vec3  ns = n_ * D.wyz - D.xzx;\n\n  vec4 j = p - 49.0 * floor(p * ns.z * ns.z);  //  mod(p,7*7)\n\n  vec4 x_ = floor(j * ns.z);\n  vec4 y_ = floor(j - 7.0 * x_ );    // mod(j,N)\n\n  vec4 x = x_ *ns.x + ns.yyyy;\n  vec4 y = y_ *ns.x + ns.yyyy;\n  vec4 h = 1.0 - abs(x) - abs(y);\n\n  vec4 b0 = vec4( x.xy, y.xy );\n  vec4 b1 = vec4( x.zw, y.zw );\n\n  //vec4 s0 = vec4(lessThan(b0,0.0))*2.0 - 1.0;\n  //vec4 s1 = vec4(lessThan(b1,0.0))*2.0 - 1.0;\n  vec4 s0 = floor(b0)*2.0 + 1.0;\n  vec4 s1 = floor(b1)*2.0 + 1.0;\n  vec4 sh = -step(h, vec4(0.0));\n\n  vec4 a0 = b0.xzyw + s0.xzyw*sh.xxyy ;\n  vec4 a1 = b1.xzyw + s1.xzyw*sh.zzww ;\n\n  vec3 p0 = vec3(a0.xy,h.x);\n  vec3 p1 = vec3(a0.zw,h.y);\n  vec3 p2 = vec3(a1.xy,h.z);\n  vec3 p3 = vec3(a1.zw,h.w);\n\n//Normalise gradients\n  vec4 norm = taylorInvSqrt(vec4(dot(p0,p0), dot(p1,p1), dot(p2, p2), dot(p3,p3)));\n  p0 *= norm.x;\n  p1 *= norm.y;\n  p2 *= norm.z;\n  p3 *= norm.w;\n\n// Mix final noise value\n  vec4 m = max(0.6 - vec4(dot(x0,x0), dot(x1,x1), dot(x2,x2), dot(x3,x3)), 0.0);\n  m = m * m;\n  return 42.0 * dot( m*m, vec4( dot(p0,x0), dot(p1,x1),\n                                dot(p2,x2), dot(p3,x3) ) );\n  }\n\nvec3 rotate(vec3 pt, float theta){\n  float c = cos(theta);\n  float s = sin(theta);\n  float aspect = 2.0/1.5;\n  mat3 mat = mat3(c,s,1, \n                  -s,c, 1, \n                  s,c, 1);\n \n  pt = mat * pt;\n  \n  return pt;\n}\n\nvoid main(){\n  vec3 rotPoints = rotate(vPosition, u_time * 0.02);\n  float n = snoise( rotPoints );\n  float ring = fract( u_Frequency * vPosition.z + u_NoiseScale * n );\n  ring *= u_Contrast * ( 1.0 - ring );\n\n  // Adjust ring smoothness and shape, and add some noise\n  float lerp = pow( ring, u_RingScale ) + n;\n  vec3 color = mix(u_DarkColor, u_LightColor, lerp);\n\n    // vec3 color = vec3(0.6);\n\n  gl_FragColor = vec4(color, 1.0);\n}\n\n//   precision mediump float;\n//   uniform vec4 color;\n//   void main () {\n//     gl_FragColor = color;\n//   }\n\n// uniform vec2 u_mouse;\n// uniform vec2 u_resolution;\n// uniform float u_time;\n// uniform sampler2D u_tex;\n\n// varying vec2 vUv;\n\n// vec2 rotate(vec2 pt, float theta){\n//   float c = cos(theta);\n//   float s = sin(theta);\n//   mat2 mat = mat2(c,s,-s,c);\n//   return mat * pt;\n// }\n\n// void main (void)\n// {\n//   vec2 uv = vUv;\n// //   vec3 color = texture2D(u_tex, uv).rgb;\n//   vec3 color = vec3(0.9);\n  \n//   gl_FragColor = vec4(color, 1.0); \n// }"]),vert:e(["\n//   precision mediump float;\n//   attribute vec2 position;\n//   void main () {\n//     gl_Position = vec4(position, 0, 1);\n//   }\n\nprecision mediump float;\n#define GLSLIFY 1\nattribute vec3 position;\nuniform mat4 projection, view;\nuniform float u_time;\nvarying vec3 vPosition;\n\nvec3 rotate(vec3 pt, float theta){\n  float c = cos(theta);\n  float s = sin(theta);\n  float aspect = 2.0/1.5;\n  mat3 mat = mat3(2.0,      s,   1.5, \n                  -s * 2.0, 1.0, 5.0, \n                  1.0,      c, 2.0);\n \n  pt = mat * pt;\n  \n  return pt;\n}\n\nvoid main() {\t\n  vPosition = position;\n  vec3 newPosition = position - vec3(1.0);\n   newPosition = rotate(newPosition, u_time * 0.3);\n   newPosition += vec3(1.0);\n  gl_Position = projection * view * vec4( newPosition, 1 );\n}"]),attributes:{position:function(e,t){return t.positionData}},uniforms:{u_LightColor:[.6,0,.6],u_DarkColor:[0,1,1],u_time:function(e,t){return e.time*t.count/500},u_resolution:[0,0],u_Frequency:2,u_NoiseScale:6,u_RingScale:.6,u_Contrast:4},count:3});function u(e,t){return Math.random()*(t-e+1)+e}var o,f=(o=500,Array.from({length:o},function(e){return{positionData:function(e,t,n,r,i,a){for(var o=[],f=0;f<3;f++)o.push([u(e,t),u(n,r),u(i,a)]);return o}(-3,3,-2,2,-3.5,3.5)}}));console.log(f),r.frame(function(e){i(function(){r.clear({color:[.1,.1,.1,1]}),f.forEach(function(e,t){e=e.positionData;a({positionData:e,count:t})})})})},{glslify:4,regl:10,"regl-camera":9}]},{},[12]);
</script>
</html>
